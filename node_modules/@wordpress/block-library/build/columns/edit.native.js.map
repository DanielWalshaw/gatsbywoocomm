{"version":3,"sources":["@wordpress/block-library/src/columns/edit.native.js"],"names":["ALLOWED_BLOCKS","DEFAULT_COLUMNS_NUM","MIN_COLUMNS_NUM","isWider","alignmentHelpers","isFullWidth","ColumnsEditContainer","attributes","updateAlignment","updateColumns","columnCount","isSelected","onDeleteBlock","innerWidths","updateInnerColumnWidth","editorSidebarOpened","resizeListener","sizes","columnsInRow","setColumnsInRow","screenWidth","Math","floor","Dimensions","get","width","globalStyles","GlobalStylesContext","verticalAlignment","align","newColumnCount","renderAppender","isEqualWidth","styles","columnAppender","onAddBlock","contentWidths","onChangeWidth","nextWidth","valueUnit","columnId","widthWithUnit","onChangeUnit","nextUnit","index","widthWithoutUnit","parseFloat","onChange","getColumnsSliders","map","column","clientId","length","undefined","CSS_UNITS","onChangeColumnsNum","value","columns","innerBlocksSelected","ColumnsEditContainerWrapper","dispatch","ownProps","registry","setAttributes","blockEditorStore","updateBlockAttributes","select","getBlockOrder","innerBlockClientIds","forEach","innerBlockClientId","updateBlockSettings","settings","updateBlockListSettings","previousColumns","newColumns","replaceInnerBlocks","getBlocks","getBlockAttributes","innerBlocks","hasExplicitWidths","isAddingColumn","newColumnWidth","widths","onAddNextColumn","selectBlock","insertedBlock","removeBlock","ColumnsEdit","props","getBlockCount","getBlockParents","isEditorSidebarOpened","isContentEmpty","innerBlock","innerColumnsWidths","inn","parents","isDefaultColumns","hasParents","parentBlockAlignment","memoizedInnerWidths","JSON","stringify","isVisible","setIsVisible","onClose","variations"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { View, Dimensions } from 'react-native';\nimport { dropRight, times, map, compact, delay } from 'lodash';\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport {\n\tPanelBody,\n\tRangeControl,\n\tFooterMessageControl,\n\tUnitControl,\n\tgetValueAndUnit,\n\tGlobalStylesContext,\n\talignmentHelpers,\n} from '@wordpress/components';\nimport {\n\tInspectorControls,\n\tInnerBlocks,\n\tBlockControls,\n\tBlockVerticalAlignmentToolbar,\n\tBlockVariationPicker,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport { withDispatch, useSelect } from '@wordpress/data';\nimport {\n\tuseEffect,\n\tuseState,\n\tuseContext,\n\tuseMemo,\n\tuseCallback,\n\tmemo,\n} from '@wordpress/element';\nimport { useResizeObserver } from '@wordpress/compose';\nimport { createBlock } from '@wordpress/blocks';\nimport { columns } from '@wordpress/icons';\n/**\n * Internal dependencies\n */\nimport variations from './variations';\nimport styles from './editor.scss';\nimport {\n\thasExplicitPercentColumnWidths,\n\tgetMappedColumnWidths,\n\tgetRedistributedColumnWidths,\n\ttoWidthPrecision,\n\tgetWidths,\n\tgetWidthWithUnit,\n\tisPercentageUnit,\n\tCSS_UNITS,\n} from './utils';\nimport {\n\tgetColumnsInRow,\n\tcalculateContainerWidth,\n\tgetContentWidths,\n} from './columnCalculations.native';\nimport ColumnsPreview from '../column/column-preview';\n\n/**\n * Allowed blocks constant is passed to InnerBlocks precisely as specified here.\n * The contents of the array should never change.\n * The array should contain the name of each block that is allowed.\n * In columns block, the only block we allow is 'core/column'.\n *\n * @constant\n * @type {string[]}\n */\nconst ALLOWED_BLOCKS = [ 'core/column' ];\n\n/**\n * Number of columns to assume for template in case the user opts to skip\n * template option selection.\n *\n * @type {number}\n */\nconst DEFAULT_COLUMNS_NUM = 2;\n\n/**\n * Minimum number of columns in a row\n *\n * @type {number}\n */\nconst MIN_COLUMNS_NUM = 1;\n\nconst { isWider, isFullWidth } = alignmentHelpers;\n\nfunction ColumnsEditContainer( {\n\tattributes,\n\tupdateAlignment,\n\tupdateColumns,\n\tcolumnCount,\n\tisSelected,\n\tonDeleteBlock,\n\tinnerWidths,\n\tupdateInnerColumnWidth,\n\teditorSidebarOpened,\n} ) {\n\tconst [ resizeListener, sizes ] = useResizeObserver();\n\tconst [ columnsInRow, setColumnsInRow ] = useState( MIN_COLUMNS_NUM );\n\tconst screenWidth = Math.floor( Dimensions.get( 'window' ).width );\n\tconst globalStyles = useContext( GlobalStylesContext );\n\n\tconst { verticalAlignment, align } = attributes;\n\tconst { width } = sizes || {};\n\n\tuseEffect( () => {\n\t\tif ( columnCount === 0 ) {\n\t\t\tconst newColumnCount = columnCount || DEFAULT_COLUMNS_NUM;\n\t\t\tupdateColumns( columnCount, newColumnCount );\n\t\t}\n\t}, [] );\n\n\tuseEffect( () => {\n\t\tif ( width ) {\n\t\t\tif ( getColumnsInRow( width, columnCount ) !== columnsInRow ) {\n\t\t\t\tsetColumnsInRow( getColumnsInRow( width, columnCount ) );\n\t\t\t}\n\t\t}\n\t}, [ width, columnCount ] );\n\n\tconst renderAppender = () => {\n\t\tconst isEqualWidth = width === screenWidth;\n\n\t\tif ( isSelected ) {\n\t\t\treturn (\n\t\t\t\t<View\n\t\t\t\t\tstyle={\n\t\t\t\t\t\t( isWider( screenWidth, 'mobile' ) || isEqualWidth ) &&\n\t\t\t\t\t\tstyles.columnAppender\n\t\t\t\t\t}\n\t\t\t\t>\n\t\t\t\t\t<InnerBlocks.ButtonBlockAppender\n\t\t\t\t\t\tonAddBlock={ onAddBlock }\n\t\t\t\t\t/>\n\t\t\t\t</View>\n\t\t\t);\n\t\t}\n\t\treturn null;\n\t};\n\n\tconst contentWidths = useMemo(\n\t\t() =>\n\t\t\tgetContentWidths(\n\t\t\t\tcolumnsInRow,\n\t\t\t\twidth,\n\t\t\t\tcolumnCount,\n\t\t\t\tinnerWidths,\n\t\t\t\tglobalStyles\n\t\t\t),\n\t\t[ width, columnsInRow, columnCount, innerWidths, globalStyles ]\n\t);\n\n\tconst onAddBlock = useCallback( () => {\n\t\tupdateColumns( columnCount, columnCount + 1 );\n\t}, [ columnCount ] );\n\n\tconst onChangeWidth = ( nextWidth, valueUnit, columnId ) => {\n\t\tconst widthWithUnit = getWidthWithUnit( nextWidth, valueUnit );\n\n\t\tupdateInnerColumnWidth( widthWithUnit, columnId );\n\t};\n\n\tconst onChangeUnit = ( nextUnit, index, columnId ) => {\n\t\tconst widthWithoutUnit = parseFloat(\n\t\t\tgetWidths( innerWidths )[ index ]\n\t\t);\n\t\tconst widthWithUnit = getWidthWithUnit( widthWithoutUnit, nextUnit );\n\n\t\tupdateInnerColumnWidth( widthWithUnit, columnId );\n\t};\n\n\tconst onChange = ( nextWidth, valueUnit, columnId ) => {\n\t\tif ( isPercentageUnit( valueUnit ) || ! valueUnit ) {\n\t\t\treturn;\n\t\t}\n\t\tonChangeWidth( nextWidth, valueUnit, columnId );\n\t};\n\n\tconst getColumnsSliders = useMemo( () => {\n\t\tif ( ! editorSidebarOpened || ! isSelected ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn innerWidths.map( ( column, index ) => {\n\t\t\tconst { valueUnit = '%' } =\n\t\t\t\tgetValueAndUnit( column.attributes.width ) || {};\n\t\t\treturn (\n\t\t\t\t<UnitControl\n\t\t\t\t\tlabel={ `Column ${ index + 1 }` }\n\t\t\t\t\tsettingLabel=\"Width\"\n\t\t\t\t\tkey={ `${ column.clientId }-${\n\t\t\t\t\t\tgetWidths( innerWidths ).length\n\t\t\t\t\t}` }\n\t\t\t\t\tmin={ 1 }\n\t\t\t\t\tmax={\n\t\t\t\t\t\tisPercentageUnit( valueUnit ) || ! valueUnit\n\t\t\t\t\t\t\t? 100\n\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t}\n\t\t\t\t\tdecimalNum={ 1 }\n\t\t\t\t\tvalue={ getWidths( innerWidths )[ index ] }\n\t\t\t\t\tonChange={ ( nextWidth ) => {\n\t\t\t\t\t\tonChange( nextWidth, valueUnit, column.clientId );\n\t\t\t\t\t} }\n\t\t\t\t\tonUnitChange={ ( nextUnit ) =>\n\t\t\t\t\t\tonChangeUnit( nextUnit, index, column.clientId )\n\t\t\t\t\t}\n\t\t\t\t\tonComplete={ ( nextWidth ) => {\n\t\t\t\t\t\tonChangeWidth( nextWidth, valueUnit, column.clientId );\n\t\t\t\t\t} }\n\t\t\t\t\tunit={ valueUnit }\n\t\t\t\t\tunits={ CSS_UNITS }\n\t\t\t\t\tpreview={\n\t\t\t\t\t\t<ColumnsPreview\n\t\t\t\t\t\t\tcolumnWidths={ getWidths( innerWidths, false ) }\n\t\t\t\t\t\t\tselectedColumnIndex={ index }\n\t\t\t\t\t\t/>\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t);\n\t\t} );\n\t}, [ editorSidebarOpened, isSelected, innerWidths ] );\n\n\tconst onChangeColumnsNum = useCallback(\n\t\t( value ) => {\n\t\t\tupdateColumns( columnCount, value );\n\t\t},\n\t\t[ columnCount ]\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t{ isSelected && (\n\t\t\t\t<>\n\t\t\t\t\t<InspectorControls>\n\t\t\t\t\t\t<PanelBody title={ __( 'Columns Settings' ) }>\n\t\t\t\t\t\t\t<RangeControl\n\t\t\t\t\t\t\t\tlabel={ __( 'Number of columns' ) }\n\t\t\t\t\t\t\t\ticon={ columns }\n\t\t\t\t\t\t\t\tvalue={ columnCount }\n\t\t\t\t\t\t\t\tonChange={ onChangeColumnsNum }\n\t\t\t\t\t\t\t\tmin={ MIN_COLUMNS_NUM }\n\t\t\t\t\t\t\t\tmax={ columnCount + 1 }\n\t\t\t\t\t\t\t\ttype=\"stepper\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{ getColumnsSliders }\n\t\t\t\t\t\t</PanelBody>\n\t\t\t\t\t\t<PanelBody>\n\t\t\t\t\t\t\t<FooterMessageControl\n\t\t\t\t\t\t\t\tlabel={ __(\n\t\t\t\t\t\t\t\t\t'Note: Column layout may vary between themes and screen sizes'\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</PanelBody>\n\t\t\t\t\t</InspectorControls>\n\t\t\t\t\t<BlockControls>\n\t\t\t\t\t\t<BlockVerticalAlignmentToolbar\n\t\t\t\t\t\t\tonChange={ updateAlignment }\n\t\t\t\t\t\t\tvalue={ verticalAlignment }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</BlockControls>\n\t\t\t\t</>\n\t\t\t) }\n\t\t\t<View style={ isSelected && styles.innerBlocksSelected }>\n\t\t\t\t{ resizeListener }\n\t\t\t\t{ width && (\n\t\t\t\t\t<InnerBlocks\n\t\t\t\t\t\trenderAppender={ renderAppender }\n\t\t\t\t\t\torientation={\n\t\t\t\t\t\t\tcolumnsInRow > 1 ? 'horizontal' : undefined\n\t\t\t\t\t\t}\n\t\t\t\t\t\thorizontal={ true }\n\t\t\t\t\t\tallowedBlocks={ ALLOWED_BLOCKS }\n\t\t\t\t\t\tcontentResizeMode=\"stretch\"\n\t\t\t\t\t\tonAddBlock={ onAddBlock }\n\t\t\t\t\t\tonDeleteBlock={\n\t\t\t\t\t\t\tcolumnCount === 1 ? onDeleteBlock : undefined\n\t\t\t\t\t\t}\n\t\t\t\t\t\tblockWidth={ width }\n\t\t\t\t\t\tcontentStyle={ contentWidths }\n\t\t\t\t\t\tparentWidth={\n\t\t\t\t\t\t\tisFullWidth( align ) && columnCount === 0\n\t\t\t\t\t\t\t\t? screenWidth\n\t\t\t\t\t\t\t\t: calculateContainerWidth( width, columnsInRow )\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t</View>\n\t\t</>\n\t);\n}\n\nconst ColumnsEditContainerWrapper = withDispatch(\n\t( dispatch, ownProps, registry ) => ( {\n\t\t/**\n\t\t * Update all child Column blocks with a new vertical alignment setting\n\t\t * based on whatever alignment is passed in. This allows change to parent\n\t\t * to overide anything set on a individual column basis.\n\t\t *\n\t\t * @param {string} verticalAlignment the vertical alignment setting\n\t\t */\n\t\tupdateAlignment( verticalAlignment ) {\n\t\t\tconst { clientId, setAttributes } = ownProps;\n\t\t\tconst { updateBlockAttributes } = dispatch( blockEditorStore );\n\t\t\tconst { getBlockOrder } = registry.select( blockEditorStore );\n\n\t\t\t// Update own alignment.\n\t\t\tsetAttributes( { verticalAlignment } );\n\n\t\t\t// Update all child Column Blocks to match\n\t\t\tconst innerBlockClientIds = getBlockOrder( clientId );\n\t\t\tinnerBlockClientIds.forEach( ( innerBlockClientId ) => {\n\t\t\t\tupdateBlockAttributes( innerBlockClientId, {\n\t\t\t\t\tverticalAlignment,\n\t\t\t\t} );\n\t\t\t} );\n\t\t},\n\t\tupdateInnerColumnWidth( value, columnId ) {\n\t\t\tconst { updateBlockAttributes } = dispatch( blockEditorStore );\n\n\t\t\tupdateBlockAttributes( columnId, {\n\t\t\t\twidth: value,\n\t\t\t} );\n\t\t},\n\t\tupdateBlockSettings( settings ) {\n\t\t\tconst { clientId } = ownProps;\n\t\t\tconst { updateBlockListSettings } = dispatch( blockEditorStore );\n\t\t\tupdateBlockListSettings( clientId, settings );\n\t\t},\n\t\t/**\n\t\t * Updates the column columnCount, including necessary revisions to child Column\n\t\t * blocks to grant required or redistribute available space.\n\t\t *\n\t\t * @param {number} previousColumns Previous column columnCount.\n\t\t * @param {number} newColumns      New column columnCount.\n\t\t */\n\t\tupdateColumns( previousColumns, newColumns ) {\n\t\t\tconst { clientId } = ownProps;\n\t\t\tconst { replaceInnerBlocks } = dispatch( blockEditorStore );\n\t\t\tconst { getBlocks, getBlockAttributes } = registry.select(\n\t\t\t\tblockEditorStore\n\t\t\t);\n\n\t\t\tlet innerBlocks = getBlocks( clientId );\n\t\t\tconst hasExplicitWidths = hasExplicitPercentColumnWidths(\n\t\t\t\tinnerBlocks\n\t\t\t);\n\n\t\t\t// Redistribute available width for existing inner blocks.\n\t\t\tconst isAddingColumn = newColumns > previousColumns;\n\n\t\t\t// Get verticalAlignment from Columns block to set the same to new Column\n\t\t\tconst { verticalAlignment } = getBlockAttributes( clientId ) || {};\n\n\t\t\tif ( isAddingColumn && hasExplicitWidths ) {\n\t\t\t\t// If adding a new column, assign width to the new column equal to\n\t\t\t\t// as if it were `1 / columns` of the total available space.\n\t\t\t\tconst newColumnWidth = toWidthPrecision( 100 / newColumns );\n\n\t\t\t\t// Redistribute in consideration of pending block insertion as\n\t\t\t\t// constraining the available working width.\n\t\t\t\tconst widths = getRedistributedColumnWidths(\n\t\t\t\t\tinnerBlocks,\n\t\t\t\t\t100 - newColumnWidth\n\t\t\t\t);\n\n\t\t\t\tinnerBlocks = [\n\t\t\t\t\t...getMappedColumnWidths( innerBlocks, widths ),\n\t\t\t\t\t...times( newColumns - previousColumns, () => {\n\t\t\t\t\t\treturn createBlock( 'core/column', {\n\t\t\t\t\t\t\twidth: newColumnWidth,\n\t\t\t\t\t\t\tverticalAlignment,\n\t\t\t\t\t\t} );\n\t\t\t\t\t} ),\n\t\t\t\t];\n\t\t\t} else if ( isAddingColumn ) {\n\t\t\t\tinnerBlocks = [\n\t\t\t\t\t...innerBlocks,\n\t\t\t\t\t...times( newColumns - previousColumns, () => {\n\t\t\t\t\t\treturn createBlock( 'core/column', {\n\t\t\t\t\t\t\tverticalAlignment,\n\t\t\t\t\t\t} );\n\t\t\t\t\t} ),\n\t\t\t\t];\n\t\t\t} else {\n\t\t\t\t// The removed column will be the last of the inner blocks.\n\t\t\t\tinnerBlocks = dropRight(\n\t\t\t\t\tinnerBlocks,\n\t\t\t\t\tpreviousColumns - newColumns\n\t\t\t\t);\n\n\t\t\t\tif ( hasExplicitWidths ) {\n\t\t\t\t\t// Redistribute as if block is already removed.\n\t\t\t\t\tconst widths = getRedistributedColumnWidths(\n\t\t\t\t\t\tinnerBlocks,\n\t\t\t\t\t\t100\n\t\t\t\t\t);\n\n\t\t\t\t\tinnerBlocks = getMappedColumnWidths( innerBlocks, widths );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treplaceInnerBlocks( clientId, innerBlocks );\n\t\t},\n\t\tonAddNextColumn: () => {\n\t\t\tconst { clientId } = ownProps;\n\t\t\tconst { replaceInnerBlocks, selectBlock } = dispatch(\n\t\t\t\tblockEditorStore\n\t\t\t);\n\t\t\tconst { getBlocks, getBlockAttributes } = registry.select(\n\t\t\t\tblockEditorStore\n\t\t\t);\n\n\t\t\t// Get verticalAlignment from Columns block to set the same to new Column\n\t\t\tconst { verticalAlignment } = getBlockAttributes( clientId );\n\n\t\t\tconst innerBlocks = getBlocks( clientId );\n\n\t\t\tconst insertedBlock = createBlock( 'core/column', {\n\t\t\t\tverticalAlignment,\n\t\t\t} );\n\n\t\t\treplaceInnerBlocks(\n\t\t\t\tclientId,\n\t\t\t\t[ ...innerBlocks, insertedBlock ],\n\t\t\t\ttrue\n\t\t\t);\n\t\t\tselectBlock( insertedBlock.clientId );\n\t\t},\n\t\tonDeleteBlock: () => {\n\t\t\tconst { clientId } = ownProps;\n\t\t\tconst { removeBlock } = dispatch( blockEditorStore );\n\t\t\tremoveBlock( clientId );\n\t\t},\n\t} )\n)( memo( ColumnsEditContainer ) );\n\nconst ColumnsEdit = ( props ) => {\n\tconst { clientId, isSelected } = props;\n\tconst {\n\t\tcolumnCount,\n\t\tisDefaultColumns,\n\t\tinnerWidths = [],\n\t\thasParents,\n\t\tparentBlockAlignment,\n\t\teditorSidebarOpened,\n\t} = useSelect(\n\t\t( select ) => {\n\t\t\tconst {\n\t\t\t\tgetBlockCount,\n\t\t\t\tgetBlocks,\n\t\t\t\tgetBlockParents,\n\t\t\t\tgetBlockAttributes,\n\t\t\t} = select( blockEditorStore );\n\t\t\tconst { isEditorSidebarOpened } = select( 'core/edit-post' );\n\t\t\tconst innerBlocks = getBlocks( clientId );\n\n\t\t\tconst isContentEmpty = map(\n\t\t\t\tinnerBlocks,\n\t\t\t\t( innerBlock ) => innerBlock.innerBlocks.length\n\t\t\t);\n\n\t\t\tconst innerColumnsWidths = innerBlocks.map( ( inn ) => ( {\n\t\t\t\tclientId: inn.clientId,\n\t\t\t\tattributes: { width: inn.attributes.width },\n\t\t\t} ) );\n\t\t\tconst parents = getBlockParents( clientId, true );\n\n\t\t\treturn {\n\t\t\t\tcolumnCount: getBlockCount( clientId ),\n\t\t\t\tisDefaultColumns: ! compact( isContentEmpty ).length,\n\t\t\t\tinnerWidths: innerColumnsWidths,\n\t\t\t\thasParents: !! parents.length,\n\t\t\t\tparentBlockAlignment: getBlockAttributes( parents[ 0 ] )?.align,\n\t\t\t\teditorSidebarOpened: isSelected && isEditorSidebarOpened(),\n\t\t\t};\n\t\t},\n\t\t[ clientId, isSelected ]\n\t);\n\n\tconst memoizedInnerWidths = useMemo( () => {\n\t\treturn innerWidths;\n\t}, [\n\t\t// The JSON.stringify is used because innerWidth is always a new reference.\n\t\t// The innerBlocks is a new reference after each attribute change of any nested block.\n\t\tJSON.stringify( innerWidths ),\n\t] );\n\n\tconst [ isVisible, setIsVisible ] = useState( false );\n\n\tuseEffect( () => {\n\t\tif ( isSelected && isDefaultColumns ) {\n\t\t\tdelay( () => setIsVisible( true ), 100 );\n\t\t}\n\t}, [] );\n\n\tconst onClose = useCallback( () => {\n\t\tsetIsVisible( false );\n\t}, [] );\n\n\treturn (\n\t\t<>\n\t\t\t<ColumnsEditContainerWrapper\n\t\t\t\tcolumnCount={ columnCount }\n\t\t\t\tinnerWidths={ memoizedInnerWidths }\n\t\t\t\thasParents={ hasParents }\n\t\t\t\tparentBlockAlignment={ parentBlockAlignment }\n\t\t\t\teditorSidebarOpened={ editorSidebarOpened }\n\t\t\t\t{ ...props }\n\t\t\t/>\n\t\t\t<BlockVariationPicker\n\t\t\t\tvariations={ variations }\n\t\t\t\tonClose={ onClose }\n\t\t\t\tclientId={ clientId }\n\t\t\t\tisVisible={ isVisible }\n\t\t\t/>\n\t\t</>\n\t);\n};\n\nexport default ColumnsEdit;\n"]}