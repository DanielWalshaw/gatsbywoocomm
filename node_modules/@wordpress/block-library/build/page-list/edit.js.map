{"version":3,"sources":["@wordpress/block-library/src/page-list/edit.js"],"names":["MAX_PAGE_COUNT","PageListEdit","context","clientId","textColor","backgroundColor","showSubmenuIcon","style","allowConvertToLinks","setAllowConvertToLinks","blockProps","className","color","isParentNavigation","select","blockEditorStore","getBlockParentsByBlockName","length","path","per_page","_fields","parse","then","res","headers","get","isOpen","setOpen","openModal","closeModal"],"mappings":";;;;;;;;;AAgBA;;;;;;AAbA;;AAKA;;AAKA;;AACA;;AACA;;AAEA;;AACA;;AACA;;AAKA;;;;;;AAEA;AACA;AACA,IAAMA,cAAc,GAAG,GAAvB;;AAEe,SAASC,YAAT,OAA+C;AAAA;;AAAA,MAAtBC,OAAsB,QAAtBA,OAAsB;AAAA,MAAbC,QAAa,QAAbA,QAAa;;AAAA,cAE5DD,OAAO,IAAI,EAFiD;AAAA,MACrDE,SADqD,SACrDA,SADqD;AAAA,MAC1CC,eAD0C,SAC1CA,eAD0C;AAAA,MACzBC,eADyB,SACzBA,eADyB;AAAA,MACRC,KADQ,SACRA,KADQ;;AAAA,kBAIL,uBAAU,KAAV,CAJK;AAAA;AAAA,MAIrDC,mBAJqD;AAAA,MAIhCC,sBAJgC;;AAM7D,MAAMC,UAAU,GAAG,gCAAe;AACjCC,IAAAA,SAAS,EAAE;AACV,wBAAkB,CAAC,CAAEP;AADX,gEAEAA,SAFA,aAEsB,CAAC,CAAEA,SAFzB,8CAGV,gBAHU,EAGQ,CAAC,CAAEC,eAHX,4DAIAA,eAJA,wBAIuC,CAAC,CAAEA,eAJ1C,8CAKV,oBALU,EAKY,CAAC,CAAEC,eALf,gBADsB;AAQjCC,IAAAA,KAAK,oBAAOA,KAAP,aAAOA,KAAP,uBAAOA,KAAK,CAAEK,KAAd;AAR4B,GAAf,CAAnB;AAWA,MAAMC,kBAAkB,GAAG,qBAC1B,UAAEC,MAAF,EAAc;AAAA,kBAC0BA,MAAM,CAAEC,kBAAF,CADhC;AAAA,QACLC,0BADK,WACLA,0BADK;;AAEb,WACCA,0BAA0B,CAAEb,QAAF,EAAY,iBAAZ,CAA1B,CACEc,MADF,GACW,CAFZ;AAIA,GAPyB,EAQ1B,CAAEd,QAAF,CAR0B,CAA3B;AAWA,0BAAW,YAAM;AAChB,QAAKU,kBAAL,EAA0B;AACzB,6BAAU;AACTK,QAAAA,IAAI,EAAE,uBAAc,cAAd,EAA8B;AACnCC,UAAAA,QAAQ,EAAE,CADyB;AAEnCC,UAAAA,OAAO,EAAE,CAAE,IAAF;AAF0B,SAA9B,CADG;AAKTC,QAAAA,KAAK,EAAE;AALE,OAAV,EAMIC,IANJ,CAMU,UAAEC,GAAF,EAAW;AACpBd,QAAAA,sBAAsB,CACrBc,GAAG,CAACC,OAAJ,CAAYC,GAAZ,CAAiB,YAAjB,KAAmCzB,cADd,CAAtB;AAGA,OAVD;AAWA,KAZD,MAYO;AACNS,MAAAA,sBAAsB,CAAE,KAAF,CAAtB;AACA;AACD,GAhBD,EAgBG,CAAEI,kBAAF,CAhBH;;AA5B6D,mBA8CjC,uBAAU,KAAV,CA9CiC;AAAA;AAAA,MA8CrDa,MA9CqD;AAAA,MA8C7CC,OA9C6C;;AA+C7D,MAAMC,SAAS,GAAG,SAAZA,SAAY;AAAA,WAAMD,OAAO,CAAE,IAAF,CAAb;AAAA,GAAlB;;AACA,MAAME,UAAU,GAAG,SAAbA,UAAa;AAAA,WAAMF,OAAO,CAAE,KAAF,CAAb;AAAA,GAAnB;;AAEA,SACC,qDACGnB,mBAAmB,IACpB,4BAAC,0BAAD;AAAe,IAAA,KAAK,EAAC;AAArB,KACC,4BAAC,yBAAD;AAAe,IAAA,KAAK,EAAG,cAAI,MAAJ,CAAvB;AAAsC,IAAA,OAAO,EAAGoB;AAAhD,KACG,cAAI,MAAJ,CADH,CADD,CAFF,EAQGpB,mBAAmB,IAAIkB,MAAvB,IACD,4BAAC,4BAAD;AACC,IAAA,OAAO,EAAGG,UADX;AAEC,IAAA,QAAQ,EAAG1B;AAFZ,IATF,EAcC,mCAAUO,UAAV,EACC,4BAAC,yBAAD;AAAkB,IAAA,KAAK,EAAC;AAAxB,IADD,CAdD,CADD;AAoBA","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tBlockControls,\n\tuseBlockProps,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport ServerSideRender from '@wordpress/server-side-render';\nimport { ToolbarButton } from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport { useEffect, useState } from '@wordpress/element';\nimport { useSelect } from '@wordpress/data';\nimport apiFetch from '@wordpress/api-fetch';\nimport { addQueryArgs } from '@wordpress/url';\n\n/**\n * Internal dependencies\n */\nimport ConvertToLinksModal from './convert-to-links-modal';\n\n// We only show the edit option when page count is <= MAX_PAGE_COUNT\n// Performance of Navigation Links is not good past this value.\nconst MAX_PAGE_COUNT = 100;\n\nexport default function PageListEdit( { context, clientId } ) {\n\tconst { textColor, backgroundColor, showSubmenuIcon, style } =\n\t\tcontext || {};\n\n\tconst [ allowConvertToLinks, setAllowConvertToLinks ] = useState( false );\n\n\tconst blockProps = useBlockProps( {\n\t\tclassName: classnames( {\n\t\t\t'has-text-color': !! textColor,\n\t\t\t[ `has-${ textColor }-color` ]: !! textColor,\n\t\t\t'has-background': !! backgroundColor,\n\t\t\t[ `has-${ backgroundColor }-background-color` ]: !! backgroundColor,\n\t\t\t'show-submenu-icons': !! showSubmenuIcon,\n\t\t} ),\n\t\tstyle: { ...style?.color },\n\t} );\n\n\tconst isParentNavigation = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getBlockParentsByBlockName } = select( blockEditorStore );\n\t\t\treturn (\n\t\t\t\tgetBlockParentsByBlockName( clientId, 'core/navigation' )\n\t\t\t\t\t.length > 0\n\t\t\t);\n\t\t},\n\t\t[ clientId ]\n\t);\n\n\tuseEffect( () => {\n\t\tif ( isParentNavigation ) {\n\t\t\tapiFetch( {\n\t\t\t\tpath: addQueryArgs( '/wp/v2/pages', {\n\t\t\t\t\tper_page: 1,\n\t\t\t\t\t_fields: [ 'id' ],\n\t\t\t\t} ),\n\t\t\t\tparse: false,\n\t\t\t} ).then( ( res ) => {\n\t\t\t\tsetAllowConvertToLinks(\n\t\t\t\t\tres.headers.get( 'X-WP-Total' ) <= MAX_PAGE_COUNT\n\t\t\t\t);\n\t\t\t} );\n\t\t} else {\n\t\t\tsetAllowConvertToLinks( false );\n\t\t}\n\t}, [ isParentNavigation ] );\n\n\tconst [ isOpen, setOpen ] = useState( false );\n\tconst openModal = () => setOpen( true );\n\tconst closeModal = () => setOpen( false );\n\n\treturn (\n\t\t<>\n\t\t\t{ allowConvertToLinks && (\n\t\t\t\t<BlockControls group=\"other\">\n\t\t\t\t\t<ToolbarButton title={ __( 'Edit' ) } onClick={ openModal }>\n\t\t\t\t\t\t{ __( 'Edit' ) }\n\t\t\t\t\t</ToolbarButton>\n\t\t\t\t</BlockControls>\n\t\t\t) }\n\t\t\t{ allowConvertToLinks && isOpen && (\n\t\t\t\t<ConvertToLinksModal\n\t\t\t\t\tonClose={ closeModal }\n\t\t\t\t\tclientId={ clientId }\n\t\t\t\t/>\n\t\t\t) }\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<ServerSideRender block=\"core/page-list\" />\n\t\t\t</div>\n\t\t</>\n\t);\n}\n"]}