{"version":3,"sources":["@wordpress/block-library/src/navigation/edit.js"],"names":["ALLOWED_BLOCKS","LAYOUT","type","alignments","Navigation","selectedBlockHasDescendants","attributes","setAttributes","clientId","hasExistingNavItems","isImmediateParentOfSelectedBlock","isSelected","updateInnerBlocks","className","hasSubmenuIndicatorSetting","hasItemJustificationControls","isPlaceholderShown","setIsPlaceholderShown","blockEditorStore","selectBlock","blockProps","itemsJustification","orientation","navigatorToolbarButton","navigatorModal","innerBlocksProps","allowedBlocks","renderAppender","InnerBlocks","DefaultAppender","__experimentalAppenderTagName","__experimentalCaptureToolbars","templateLock","__experimentalLayout","placeholder","blocks","selectNavigationBlock","justifyAllowedControls","value","position","isAlternate","showSubmenuIcon","select","innerBlocks","getBlocks","getClientIdsOfDescendants","hasSelectedInnerBlock","getSelectedBlockClientId","selectedBlockId","length","dispatch","replaceInnerBlocks"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { useState } from '@wordpress/element';\nimport {\n\tInnerBlocks,\n\t__experimentalUseInnerBlocksProps as useInnerBlocksProps,\n\tInspectorControls,\n\tJustifyToolbar,\n\tBlockControls,\n\tuseBlockProps,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport { useDispatch, withSelect, withDispatch } from '@wordpress/data';\nimport { PanelBody, ToggleControl, ToolbarGroup } from '@wordpress/components';\nimport { compose } from '@wordpress/compose';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport useBlockNavigator from './use-block-navigator';\n\nimport NavigationPlaceholder from './placeholder';\nimport PlaceholderPreview from './placeholder-preview';\n\nconst ALLOWED_BLOCKS = [\n\t'core/navigation-link',\n\t'core/search',\n\t'core/social-links',\n\t'core/page-list',\n\t'core/spacer',\n];\n\nconst LAYOUT = {\n\ttype: 'default',\n\talignments: [],\n};\n\nfunction Navigation( {\n\tselectedBlockHasDescendants,\n\tattributes,\n\tsetAttributes,\n\tclientId,\n\thasExistingNavItems,\n\tisImmediateParentOfSelectedBlock,\n\tisSelected,\n\tupdateInnerBlocks,\n\tclassName,\n\thasSubmenuIndicatorSetting = true,\n\thasItemJustificationControls = true,\n} ) {\n\tconst [ isPlaceholderShown, setIsPlaceholderShown ] = useState(\n\t\t! hasExistingNavItems\n\t);\n\n\tconst { selectBlock } = useDispatch( blockEditorStore );\n\n\tconst blockProps = useBlockProps( {\n\t\tclassName: classnames( className, {\n\t\t\t[ `items-justified-${ attributes.itemsJustification }` ]: attributes.itemsJustification,\n\t\t\t'is-vertical': attributes.orientation === 'vertical',\n\t\t} ),\n\t} );\n\n\tconst { navigatorToolbarButton, navigatorModal } = useBlockNavigator(\n\t\tclientId\n\t);\n\n\tconst innerBlocksProps = useInnerBlocksProps(\n\t\t{\n\t\t\tclassName: 'wp-block-navigation__container',\n\t\t},\n\t\t{\n\t\t\tallowedBlocks: ALLOWED_BLOCKS,\n\t\t\torientation: attributes.orientation || 'horizontal',\n\t\t\trenderAppender:\n\t\t\t\t( isImmediateParentOfSelectedBlock &&\n\t\t\t\t\t! selectedBlockHasDescendants ) ||\n\t\t\t\tisSelected\n\t\t\t\t\t? InnerBlocks.DefaultAppender\n\t\t\t\t\t: false,\n\t\t\t__experimentalAppenderTagName: 'li',\n\t\t\t__experimentalCaptureToolbars: true,\n\t\t\t// Template lock set to false here so that the Nav\n\t\t\t// Block on the experimental menus screen does not\n\t\t\t// inherit templateLock={ 'all' }.\n\t\t\ttemplateLock: false,\n\t\t\t__experimentalLayout: LAYOUT,\n\t\t\tplaceholder: <PlaceholderPreview />,\n\t\t}\n\t);\n\n\tif ( isPlaceholderShown ) {\n\t\treturn (\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<NavigationPlaceholder\n\t\t\t\t\tonCreate={ ( blocks, selectNavigationBlock ) => {\n\t\t\t\t\t\tsetIsPlaceholderShown( false );\n\t\t\t\t\t\tupdateInnerBlocks( blocks );\n\t\t\t\t\t\tif ( selectNavigationBlock ) {\n\t\t\t\t\t\t\tselectBlock( clientId );\n\t\t\t\t\t\t}\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tconst justifyAllowedControls =\n\t\tattributes.orientation === 'vertical'\n\t\t\t? [ 'left', 'center', 'right' ]\n\t\t\t: [ 'left', 'center', 'right', 'space-between' ];\n\n\treturn (\n\t\t<>\n\t\t\t<BlockControls>\n\t\t\t\t{ hasItemJustificationControls && (\n\t\t\t\t\t<JustifyToolbar\n\t\t\t\t\t\tvalue={ attributes.itemsJustification }\n\t\t\t\t\t\tallowedControls={ justifyAllowedControls }\n\t\t\t\t\t\tonChange={ ( value ) =>\n\t\t\t\t\t\t\tsetAttributes( { itemsJustification: value } )\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpopoverProps={ {\n\t\t\t\t\t\t\tposition: 'bottom right',\n\t\t\t\t\t\t\tisAlternate: true,\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t\t<ToolbarGroup>{ navigatorToolbarButton }</ToolbarGroup>\n\t\t\t</BlockControls>\n\t\t\t{ navigatorModal }\n\t\t\t<InspectorControls>\n\t\t\t\t{ hasSubmenuIndicatorSetting && (\n\t\t\t\t\t<PanelBody title={ __( 'Display settings' ) }>\n\t\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\t\tchecked={ attributes.showSubmenuIcon }\n\t\t\t\t\t\t\tonChange={ ( value ) => {\n\t\t\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\t\t\tshowSubmenuIcon: value,\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\tlabel={ __( 'Show submenu indicator icons' ) }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</PanelBody>\n\t\t\t\t) }\n\t\t\t</InspectorControls>\n\t\t\t<nav { ...blockProps }>\n\t\t\t\t<ul { ...innerBlocksProps } />\n\t\t\t</nav>\n\t\t</>\n\t);\n}\n\nexport default compose( [\n\twithSelect( ( select, { clientId } ) => {\n\t\tconst innerBlocks = select( blockEditorStore ).getBlocks( clientId );\n\t\tconst {\n\t\t\tgetClientIdsOfDescendants,\n\t\t\thasSelectedInnerBlock,\n\t\t\tgetSelectedBlockClientId,\n\t\t} = select( blockEditorStore );\n\t\tconst isImmediateParentOfSelectedBlock = hasSelectedInnerBlock(\n\t\t\tclientId,\n\t\t\tfalse\n\t\t);\n\t\tconst selectedBlockId = getSelectedBlockClientId();\n\t\tconst selectedBlockHasDescendants = !! getClientIdsOfDescendants( [\n\t\t\tselectedBlockId,\n\t\t] )?.length;\n\t\treturn {\n\t\t\tisImmediateParentOfSelectedBlock,\n\t\t\tselectedBlockHasDescendants,\n\t\t\thasExistingNavItems: !! innerBlocks.length,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, { clientId } ) => {\n\t\treturn {\n\t\t\tupdateInnerBlocks( blocks ) {\n\t\t\t\tif ( blocks?.length === 0 ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tdispatch( blockEditorStore ).replaceInnerBlocks(\n\t\t\t\t\tclientId,\n\t\t\t\t\tblocks,\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t},\n\t\t};\n\t} ),\n] )( Navigation );\n"]}