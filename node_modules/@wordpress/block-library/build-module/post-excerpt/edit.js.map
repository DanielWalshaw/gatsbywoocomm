{"version":3,"sources":["@wordpress/block-library/src/post-excerpt/edit.js"],"names":["classnames","useEntityProp","useMemo","AlignmentToolbar","BlockControls","InspectorControls","RichText","Warning","useBlockProps","PanelBody","RangeControl","ToggleControl","__","usePostContentExcerpt","wordCount","postId","postType","content","rawPostContent","raw","excerptElement","document","createElement","innerHTML","excerpt","textContent","innerText","trim","split","join","PostExcerptEditor","attributes","textAlign","moreText","showMoreOnNewLine","setAttributes","isSelected","context","setExcerpt","postContentExcerpt","blockProps","className","readMoreLink","newMoreText","newAlign","newExcerptLength","newShowMoreOnNewLine"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { useEntityProp } from '@wordpress/core-data';\nimport { useMemo } from '@wordpress/element';\nimport {\n\tAlignmentToolbar,\n\tBlockControls,\n\tInspectorControls,\n\tRichText,\n\tWarning,\n\tuseBlockProps,\n} from '@wordpress/block-editor';\nimport { PanelBody, RangeControl, ToggleControl } from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\n\nfunction usePostContentExcerpt( wordCount, postId, postType ) {\n\t// Don't destrcuture items from content here, it can be undefined.\n\tconst [ , , content ] = useEntityProp(\n\t\t'postType',\n\t\tpostType,\n\t\t'content',\n\t\tpostId\n\t);\n\tconst rawPostContent = content?.raw;\n\treturn useMemo( () => {\n\t\tif ( ! rawPostContent ) {\n\t\t\treturn '';\n\t\t}\n\t\tconst excerptElement = document.createElement( 'div' );\n\t\texcerptElement.innerHTML = rawPostContent;\n\t\tconst excerpt =\n\t\t\texcerptElement.textContent || excerptElement.innerText || '';\n\t\treturn excerpt.trim().split( ' ', wordCount ).join( ' ' );\n\t}, [ rawPostContent, wordCount ] );\n}\n\nexport default function PostExcerptEditor( {\n\tattributes: { textAlign, wordCount, moreText, showMoreOnNewLine },\n\tsetAttributes,\n\tisSelected,\n\tcontext: { postId, postType },\n} ) {\n\tconst [ excerpt, setExcerpt ] = useEntityProp(\n\t\t'postType',\n\t\tpostType,\n\t\t'excerpt',\n\t\tpostId\n\t);\n\tconst postContentExcerpt = usePostContentExcerpt(\n\t\twordCount,\n\t\tpostId,\n\t\tpostType\n\t);\n\tconst blockProps = useBlockProps( {\n\t\tclassName: classnames( {\n\t\t\t[ `has-text-align-${ textAlign }` ]: textAlign,\n\t\t} ),\n\t} );\n\n\tif ( ! postType || ! postId ) {\n\t\treturn (\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<Warning>\n\t\t\t\t\t{ __( 'Post excerpt block: no post found.' ) }\n\t\t\t\t</Warning>\n\t\t\t</div>\n\t\t);\n\t}\n\tconst readMoreLink = (\n\t\t<RichText\n\t\t\tclassName=\"wp-block-post-excerpt__more-link\"\n\t\t\ttagName=\"a\"\n\t\t\taria-label={ __( 'Read more link text' ) }\n\t\t\tplaceholder={ __( 'Read moreâ€¦' ) }\n\t\t\tvalue={ moreText }\n\t\t\tonChange={ ( newMoreText ) =>\n\t\t\t\tsetAttributes( { moreText: newMoreText } )\n\t\t\t}\n\t\t/>\n\t);\n\treturn (\n\t\t<>\n\t\t\t<BlockControls>\n\t\t\t\t<AlignmentToolbar\n\t\t\t\t\tvalue={ textAlign }\n\t\t\t\t\tonChange={ ( newAlign ) =>\n\t\t\t\t\t\tsetAttributes( { textAlign: newAlign } )\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t</BlockControls>\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={ __( 'Post Excerpt Settings' ) }>\n\t\t\t\t\t{ ! excerpt && (\n\t\t\t\t\t\t<RangeControl\n\t\t\t\t\t\t\tlabel={ __( 'Max words' ) }\n\t\t\t\t\t\t\tvalue={ wordCount }\n\t\t\t\t\t\t\tonChange={ ( newExcerptLength ) =>\n\t\t\t\t\t\t\t\tsetAttributes( { wordCount: newExcerptLength } )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tmin={ 10 }\n\t\t\t\t\t\t\tmax={ 100 }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\tlabel={ __( 'Show link on new line' ) }\n\t\t\t\t\t\tchecked={ showMoreOnNewLine }\n\t\t\t\t\t\tonChange={ ( newShowMoreOnNewLine ) =>\n\t\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\t\tshowMoreOnNewLine: newShowMoreOnNewLine,\n\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<RichText\n\t\t\t\t\tclassName={\n\t\t\t\t\t\t! showMoreOnNewLine &&\n\t\t\t\t\t\t'wp-block-post-excerpt__excerpt is-inline'\n\t\t\t\t\t}\n\t\t\t\t\taria-label={ __( 'Post excerpt text' ) }\n\t\t\t\t\tvalue={\n\t\t\t\t\t\texcerpt ||\n\t\t\t\t\t\tpostContentExcerpt ||\n\t\t\t\t\t\t( isSelected ? '' : __( 'No post excerpt found' ) )\n\t\t\t\t\t}\n\t\t\t\t\tonChange={ setExcerpt }\n\t\t\t\t/>\n\t\t\t\t{ ! showMoreOnNewLine && ' ' }\n\t\t\t\t{ showMoreOnNewLine ? (\n\t\t\t\t\t<p className=\"wp-block-post-excerpt__more-text\">\n\t\t\t\t\t\t{ readMoreLink }\n\t\t\t\t\t</p>\n\t\t\t\t) : (\n\t\t\t\t\treadMoreLink\n\t\t\t\t) }\n\t\t\t</div>\n\t\t</>\n\t);\n}\n"]}