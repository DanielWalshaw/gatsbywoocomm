{"version":3,"sources":["@wordpress/block-library/src/block/edit.native.js"],"names":["ActivityIndicator","Platform","Text","TouchableWithoutFeedback","View","useState","useEntityBlockEditor","store","coreStore","BottomSheet","Icon","Disabled","useSelect","__","BlockEditorProvider","BlockList","blockEditorStore","usePreferredColorSchemeStyle","help","reusableBlocksStore","styles","EditTitle","ReusableBlockEdit","ref","attributes","clientId","isSelected","recordArgs","showHelp","setShowHelp","infoTextStyle","infoText","infoTextDark","infoTitleStyle","infoTitle","infoTitleDark","infoSheetIconStyle","infoSheetIcon","infoSheetIconDark","spinnerStyle","spinner","spinnerDark","select","getSettings","reusableBlock","getEditedEntityRecord","hasResolved","hasFinishedResolution","isSaving","isSavingEntityRecord","canUserUpdate","canUser","isEditing","__experimentalIsEditingReusableBlock","settings","id","blocks","onInput","onChange","openSheet","closeSheet","renderSheet","OS","infoContainer","color","size","title","element"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tActivityIndicator,\n\tPlatform,\n\tText,\n\tTouchableWithoutFeedback,\n\tView,\n} from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { useState } from '@wordpress/element';\nimport { useEntityBlockEditor, store as coreStore } from '@wordpress/core-data';\nimport { BottomSheet, Icon, Disabled } from '@wordpress/components';\nimport { useSelect } from '@wordpress/data';\nimport { __ } from '@wordpress/i18n';\nimport {\n\tBlockEditorProvider,\n\tBlockList,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport { usePreferredColorSchemeStyle } from '@wordpress/compose';\nimport { help } from '@wordpress/icons';\nimport { store as reusableBlocksStore } from '@wordpress/reusable-blocks';\n\n/**\n * Internal dependencies\n */\nimport styles from './editor.scss';\nimport EditTitle from './edit-title';\n\nexport default function ReusableBlockEdit( {\n\tattributes: { ref },\n\tclientId,\n\tisSelected,\n} ) {\n\tconst recordArgs = [ 'postType', 'wp_block', ref ];\n\n\tconst [ showHelp, setShowHelp ] = useState( false );\n\tconst infoTextStyle = usePreferredColorSchemeStyle(\n\t\tstyles.infoText,\n\t\tstyles.infoTextDark\n\t);\n\tconst infoTitleStyle = usePreferredColorSchemeStyle(\n\t\tstyles.infoTitle,\n\t\tstyles.infoTitleDark\n\t);\n\tconst infoSheetIconStyle = usePreferredColorSchemeStyle(\n\t\tstyles.infoSheetIcon,\n\t\tstyles.infoSheetIconDark\n\t);\n\tconst spinnerStyle = usePreferredColorSchemeStyle(\n\t\tstyles.spinner,\n\t\tstyles.spinnerDark\n\t);\n\n\tconst { reusableBlock, hasResolved, isEditing, settings } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getSettings } = select( blockEditorStore );\n\n\t\t\treturn {\n\t\t\t\treusableBlock: select( coreStore ).getEditedEntityRecord(\n\t\t\t\t\t...recordArgs\n\t\t\t\t),\n\t\t\t\thasResolved: select( coreStore ).hasFinishedResolution(\n\t\t\t\t\t'getEditedEntityRecord',\n\t\t\t\t\trecordArgs\n\t\t\t\t),\n\t\t\t\tisSaving: select( coreStore ).isSavingEntityRecord(\n\t\t\t\t\t...recordArgs\n\t\t\t\t),\n\t\t\t\tcanUserUpdate: select( coreStore ).canUser(\n\t\t\t\t\t'update',\n\t\t\t\t\t'blocks',\n\t\t\t\t\tref\n\t\t\t\t),\n\t\t\t\tisEditing: select(\n\t\t\t\t\treusableBlocksStore\n\t\t\t\t).__experimentalIsEditingReusableBlock( clientId ),\n\t\t\t\tsettings: getSettings(),\n\t\t\t};\n\t\t},\n\t\t[ ref, clientId ]\n\t);\n\n\tconst [ blocks, onInput, onChange ] = useEntityBlockEditor(\n\t\t'postType',\n\t\t'wp_block',\n\t\t{ id: ref }\n\t);\n\n\tfunction openSheet() {\n\t\tsetShowHelp( true );\n\t}\n\n\tfunction closeSheet() {\n\t\tsetShowHelp( false );\n\t}\n\n\tfunction renderSheet() {\n\t\tconst infoTitle =\n\t\t\tPlatform.OS === 'android'\n\t\t\t\t? __(\n\t\t\t\t\t\t\"Reusable blocks aren't editable on WordPress for Android\"\n\t\t\t\t  )\n\t\t\t\t: __( \"Reusable blocks aren't editable on WordPress for iOS\" );\n\n\t\treturn (\n\t\t\t<BottomSheet\n\t\t\t\tisVisible={ showHelp }\n\t\t\t\thideHeader\n\t\t\t\tonClose={ closeSheet }\n\t\t\t>\n\t\t\t\t<View style={ styles.infoContainer }>\n\t\t\t\t\t<Icon\n\t\t\t\t\t\ticon={ help }\n\t\t\t\t\t\tcolor={ infoSheetIconStyle.color }\n\t\t\t\t\t\tsize={ styles.infoSheetIcon.size }\n\t\t\t\t\t/>\n\t\t\t\t\t<Text style={ [ infoTextStyle, infoTitleStyle ] }>\n\t\t\t\t\t\t{ infoTitle }\n\t\t\t\t\t</Text>\n\t\t\t\t</View>\n\t\t\t</BottomSheet>\n\t\t);\n\t}\n\n\tif ( ! hasResolved ) {\n\t\treturn (\n\t\t\t<View style={ spinnerStyle }>\n\t\t\t\t<ActivityIndicator animating />\n\t\t\t</View>\n\t\t);\n\t}\n\n\tif ( ! reusableBlock ) {\n\t\treturn (\n\t\t\t<Text>{ __( 'Block has been deleted or is unavailable.' ) }</Text>\n\t\t);\n\t}\n\n\tconst { title } = reusableBlock;\n\tlet element = (\n\t\t<BlockEditorProvider\n\t\t\tsettings={ settings }\n\t\t\tvalue={ blocks }\n\t\t\tonChange={ onChange }\n\t\t\tonInput={ onInput }\n\t\t>\n\t\t\t<BlockList withFooter={ false } marginHorizontal={ 0 } />\n\t\t</BlockEditorProvider>\n\t);\n\n\tif ( ! isEditing ) {\n\t\telement = <Disabled>{ element }</Disabled>;\n\t}\n\n\treturn (\n\t\t<TouchableWithoutFeedback\n\t\t\tdisabled={ ! isSelected }\n\t\t\taccessibilityLabel={ __( 'Help button' ) }\n\t\t\taccessibilityRole={ 'button' }\n\t\t\taccessibilityHint={ __( 'Tap here to show help' ) }\n\t\t\tonPress={ openSheet }\n\t\t>\n\t\t\t<View>\n\t\t\t\t{ isSelected && <EditTitle title={ title } /> }\n\t\t\t\t{ element }\n\t\t\t\t{ renderSheet() }\n\t\t\t</View>\n\t\t</TouchableWithoutFeedback>\n\t);\n}\n"]}