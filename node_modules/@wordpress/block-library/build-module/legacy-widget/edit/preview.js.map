{"version":3,"sources":["@wordpress/block-library/src/legacy-widget/edit/preview.js"],"names":["addQueryArgs","useRef","useState","useCallback","useEffect","Disabled","__","DEFAULT_HEIGHT","PreviewIframe","idBase","instance","isVisible","ref","height","setHeight","adjustHeight","current","contentDocument","body","scrollHeight","page"],"mappings":";;;AAAA;AACA;AACA;AACA,SAASA,YAAT,QAA6B,gBAA7B;AACA,SAASC,MAAT,EAAiBC,QAAjB,EAA2BC,WAA3B,EAAwCC,SAAxC,QAAyD,oBAAzD;AACA,SAASC,QAAT,QAAyB,uBAAzB;AACA,SAASC,EAAT,QAAmB,iBAAnB;AAEA,IAAMC,cAAc,GAAG,GAAvB;AAEA,eAAe,SAASC,aAAT,OAA0D;AAAA,MAAhCC,MAAgC,QAAhCA,MAAgC;AAAA,MAAxBC,QAAwB,QAAxBA,QAAwB;AAAA,MAAdC,SAAc,QAAdA,SAAc;AACxE,MAAMC,GAAG,GAAGX,MAAM,EAAlB;;AADwE,kBAG1CC,QAAQ,CAAEK,cAAF,CAHkC;AAAA;AAAA,MAGhEM,MAHgE;AAAA,MAGxDC,SAHwD;;AAKxE,MAAMC,YAAY,GAAGZ,WAAW,CAAE,YAAM;AACvCW,IAAAA,SAAS,CAAEF,GAAG,CAACI,OAAJ,CAAYC,eAAZ,CAA4BC,IAA5B,CAAiCC,YAAnC,CAAT;AACA,GAF+B,EAE7B,EAF6B,CAAhC;AAIAf,EAAAA,SAAS,CAAE,YAAM;AAChB,QAAKO,SAAL,EAAiB;AAChBI,MAAAA,YAAY;AACZ;AACD,GAJQ,EAIN,CAAEJ,SAAF,EAAaI,YAAb,CAJM,CAAT;AAMA,SACC,cAAC,QAAD;AAAU,IAAA,MAAM,EAAG,CAAEJ;AAArB,KAOC;AACC,IAAA,GAAG,EAAGC,GADP;AAEC,IAAA,SAAS,EAAC,sCAFX;AAGC,IAAA,GAAG,EAAGZ,YAAY,CAAE,YAAF,EAAgB;AACjCoB,MAAAA,IAAI,EAAE,mBAD2B;AAEjC,+BAAyB;AACxBX,QAAAA,MAAM,EAANA,MADwB;AAExBC,QAAAA,QAAQ,EAARA;AAFwB;AAFQ,KAAhB,CAHnB;AAUC,IAAA,KAAK,EAAGJ,EAAE,CAAE,uBAAF,CAVX;AAWC,IAAA,MAAM,EAAGO,MAXV;AAYC,IAAA,MAAM,EAAGE;AAZV,IAPD,CADD;AAwBA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { addQueryArgs } from '@wordpress/url';\nimport { useRef, useState, useCallback, useEffect } from '@wordpress/element';\nimport { Disabled } from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\n\nconst DEFAULT_HEIGHT = 300;\n\nexport default function PreviewIframe( { idBase, instance, isVisible } ) {\n\tconst ref = useRef();\n\n\tconst [ height, setHeight ] = useState( DEFAULT_HEIGHT );\n\n\tconst adjustHeight = useCallback( () => {\n\t\tsetHeight( ref.current.contentDocument.body.scrollHeight );\n\t}, [] );\n\n\tuseEffect( () => {\n\t\tif ( isVisible ) {\n\t\t\tadjustHeight();\n\t\t}\n\t}, [ isVisible, adjustHeight ] );\n\n\treturn (\n\t\t<Disabled hidden={ ! isVisible }>\n\t\t\t{ /*\n\t\t\tRendering the preview in an iframe ensures compatibility with any\n\t\t\tscripts that the widget uses. TODO: This chokes when the\n\t\t\tlegacy-widget-preview query param is too big. Ideally, we'd render a\n\t\t\t<ServerSideRender> into an iframe using a portal.\n\t\t\t*/ }\n\t\t\t<iframe\n\t\t\t\tref={ ref }\n\t\t\t\tclassName=\"wp-block-legacy-widget__edit-preview\"\n\t\t\t\tsrc={ addQueryArgs( 'themes.php', {\n\t\t\t\t\tpage: 'gutenberg-widgets',\n\t\t\t\t\t'legacy-widget-preview': {\n\t\t\t\t\t\tidBase,\n\t\t\t\t\t\tinstance,\n\t\t\t\t\t},\n\t\t\t\t} ) }\n\t\t\t\ttitle={ __( 'Legacy Widget Preview' ) }\n\t\t\t\theight={ height }\n\t\t\t\tonLoad={ adjustHeight }\n\t\t\t/>\n\t\t</Disabled>\n\t);\n}\n"]}