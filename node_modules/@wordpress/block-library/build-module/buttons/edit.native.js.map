{"version":3,"sources":["@wordpress/block-library/src/buttons/edit.native.js"],"names":["debounce","View","BlockControls","InnerBlocks","JustifyContentControl","store","blockEditorStore","createBlock","useResizeObserver","useDispatch","useSelect","useState","useEffect","useRef","useCallback","alignmentHelpers","name","buttonBlockName","styles","ALLOWED_BLOCKS","BUTTONS_TEMPLATE","layoutProp","type","alignments","ButtonsEdit","attributes","contentJustification","align","clientId","isSelected","setAttributes","blockWidth","resizeObserver","sizes","maxWidth","setMaxWidth","spacing","marginLeft","select","getBlockCount","getBlockParents","getSelectedBlockClientId","selectedBlockClientId","selectedBlockParents","isInnerButtonSelected","shouldDelete","getBlockOrder","insertBlock","removeBlock","selectBlock","width","isFullWidth","isFullWidthBlock","onAddNextButton","selectedId","order","selectedButtonIndex","findIndex","i","index","length","insertedBlock","renderFooterAppender","appenderContainer","justifyControls","remove","shouldRenderFooterAppender","value","position","isAlternate","current","undefined"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { debounce } from 'lodash';\nimport { View } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tBlockControls,\n\tInnerBlocks,\n\tJustifyContentControl,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport { createBlock } from '@wordpress/blocks';\nimport { useResizeObserver } from '@wordpress/compose';\nimport { useDispatch, useSelect } from '@wordpress/data';\nimport { useState, useEffect, useRef, useCallback } from '@wordpress/element';\nimport { alignmentHelpers } from '@wordpress/components';\n\n/**\n * Internal dependencies\n */\nimport { name as buttonBlockName } from '../button/';\nimport styles from './editor.scss';\n\nconst ALLOWED_BLOCKS = [ buttonBlockName ];\nconst BUTTONS_TEMPLATE = [ [ 'core/button' ] ];\n\nconst layoutProp = { type: 'default', alignments: [] };\n\nexport default function ButtonsEdit( {\n\tattributes: { contentJustification, align },\n\tclientId,\n\tisSelected,\n\tsetAttributes,\n\tblockWidth,\n} ) {\n\tconst [ resizeObserver, sizes ] = useResizeObserver();\n\tconst [ maxWidth, setMaxWidth ] = useState( 0 );\n\tconst { marginLeft: spacing } = styles.spacing;\n\n\tconst { isInnerButtonSelected, shouldDelete } = useSelect(\n\t\t( select ) => {\n\t\t\tconst {\n\t\t\t\tgetBlockCount,\n\t\t\t\tgetBlockParents,\n\t\t\t\tgetSelectedBlockClientId,\n\t\t\t} = select( blockEditorStore );\n\t\t\tconst selectedBlockClientId = getSelectedBlockClientId();\n\t\t\tconst selectedBlockParents = getBlockParents(\n\t\t\t\tselectedBlockClientId,\n\t\t\t\ttrue\n\t\t\t);\n\n\t\t\treturn {\n\t\t\t\tisInnerButtonSelected: selectedBlockParents[ 0 ] === clientId,\n\t\t\t\t// The purpose of `shouldDelete` check is giving the ability to\n\t\t\t\t// pass to mobile toolbar function called `onDelete` which removes\n\t\t\t\t// the whole `Buttons` container along with the last inner button\n\t\t\t\t// when there is exactly one button.\n\t\t\t\tshouldDelete: getBlockCount( clientId ) === 1,\n\t\t\t};\n\t\t},\n\t\t[ clientId ]\n\t);\n\tconst { getBlockOrder } = useSelect( blockEditorStore );\n\tconst { insertBlock, removeBlock, selectBlock } = useDispatch(\n\t\tblockEditorStore\n\t);\n\n\tuseEffect( () => {\n\t\tconst { width } = sizes || {};\n\t\tconst { isFullWidth } = alignmentHelpers;\n\n\t\tif ( width ) {\n\t\t\tconst isFullWidthBlock = isFullWidth( align );\n\t\t\tsetMaxWidth( isFullWidthBlock ? blockWidth : width );\n\t\t}\n\t}, [ sizes, align ] );\n\n\tconst onAddNextButton = useCallback(\n\t\tdebounce( ( selectedId ) => {\n\t\t\tconst order = getBlockOrder( clientId );\n\t\t\tconst selectedButtonIndex = order.findIndex(\n\t\t\t\t( i ) => i === selectedId\n\t\t\t);\n\n\t\t\tconst index =\n\t\t\t\tselectedButtonIndex === -1\n\t\t\t\t\t? order.length + 1\n\t\t\t\t\t: selectedButtonIndex;\n\n\t\t\tconst insertedBlock = createBlock( 'core/button' );\n\n\t\t\tinsertBlock( insertedBlock, index, clientId );\n\t\t\tselectBlock( insertedBlock.clientId );\n\t\t}, 200 ),\n\t\t[]\n\t);\n\n\tconst renderFooterAppender = useRef( () => (\n\t\t<View style={ styles.appenderContainer }>\n\t\t\t<InnerBlocks.ButtonBlockAppender\n\t\t\t\tisFloating={ true }\n\t\t\t\tonAddBlock={ onAddNextButton }\n\t\t\t/>\n\t\t</View>\n\t) );\n\n\tconst justifyControls = [ 'left', 'center', 'right' ];\n\n\tconst remove = useCallback( () => removeBlock( clientId ), [ clientId ] );\n\tconst shouldRenderFooterAppender = isSelected || isInnerButtonSelected;\n\treturn (\n\t\t<>\n\t\t\t{ isSelected && (\n\t\t\t\t<BlockControls group=\"block\">\n\t\t\t\t\t<JustifyContentControl\n\t\t\t\t\t\tallowedControls={ justifyControls }\n\t\t\t\t\t\tvalue={ contentJustification }\n\t\t\t\t\t\tonChange={ ( value ) =>\n\t\t\t\t\t\t\tsetAttributes( { contentJustification: value } )\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpopoverProps={ {\n\t\t\t\t\t\t\tposition: 'bottom right',\n\t\t\t\t\t\t\tisAlternate: true,\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t</BlockControls>\n\t\t\t) }\n\t\t\t{ resizeObserver }\n\t\t\t<InnerBlocks\n\t\t\t\tallowedBlocks={ ALLOWED_BLOCKS }\n\t\t\t\ttemplate={ BUTTONS_TEMPLATE }\n\t\t\t\trenderFooterAppender={\n\t\t\t\t\tshouldRenderFooterAppender && renderFooterAppender.current\n\t\t\t\t}\n\t\t\t\torientation=\"horizontal\"\n\t\t\t\thorizontalAlignment={ contentJustification }\n\t\t\t\tonDeleteBlock={ shouldDelete ? remove : undefined }\n\t\t\t\tonAddBlock={ onAddNextButton }\n\t\t\t\tparentWidth={ maxWidth } // This value controls the width of that the buttons are able to expand to.\n\t\t\t\tmarginHorizontal={ spacing }\n\t\t\t\tmarginVertical={ spacing }\n\t\t\t\t__experimentalLayout={ layoutProp }\n\t\t\t\ttemplateInsertUpdatesSelection\n\t\t\t\tblockWidth={ blockWidth }\n\t\t\t/>\n\t\t</>\n\t);\n}\n"]}