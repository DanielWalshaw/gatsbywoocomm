{"version":3,"sources":["@wordpress/block-library/src/page-list/edit.js"],"names":["classnames","BlockControls","useBlockProps","store","blockEditorStore","ServerSideRender","ToolbarButton","__","useEffect","useState","useSelect","apiFetch","addQueryArgs","ConvertToLinksModal","MAX_PAGE_COUNT","PageListEdit","context","clientId","textColor","backgroundColor","showSubmenuIcon","style","allowConvertToLinks","setAllowConvertToLinks","blockProps","className","color","isParentNavigation","select","getBlockParentsByBlockName","length","path","per_page","_fields","parse","then","res","headers","get","isOpen","setOpen","openModal","closeModal"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tBlockControls,\n\tuseBlockProps,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport ServerSideRender from '@wordpress/server-side-render';\nimport { ToolbarButton } from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport { useEffect, useState } from '@wordpress/element';\nimport { useSelect } from '@wordpress/data';\nimport apiFetch from '@wordpress/api-fetch';\nimport { addQueryArgs } from '@wordpress/url';\n\n/**\n * Internal dependencies\n */\nimport ConvertToLinksModal from './convert-to-links-modal';\n\n// We only show the edit option when page count is <= MAX_PAGE_COUNT\n// Performance of Navigation Links is not good past this value.\nconst MAX_PAGE_COUNT = 100;\n\nexport default function PageListEdit( { context, clientId } ) {\n\tconst { textColor, backgroundColor, showSubmenuIcon, style } =\n\t\tcontext || {};\n\n\tconst [ allowConvertToLinks, setAllowConvertToLinks ] = useState( false );\n\n\tconst blockProps = useBlockProps( {\n\t\tclassName: classnames( {\n\t\t\t'has-text-color': !! textColor,\n\t\t\t[ `has-${ textColor }-color` ]: !! textColor,\n\t\t\t'has-background': !! backgroundColor,\n\t\t\t[ `has-${ backgroundColor }-background-color` ]: !! backgroundColor,\n\t\t\t'show-submenu-icons': !! showSubmenuIcon,\n\t\t} ),\n\t\tstyle: { ...style?.color },\n\t} );\n\n\tconst isParentNavigation = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getBlockParentsByBlockName } = select( blockEditorStore );\n\t\t\treturn (\n\t\t\t\tgetBlockParentsByBlockName( clientId, 'core/navigation' )\n\t\t\t\t\t.length > 0\n\t\t\t);\n\t\t},\n\t\t[ clientId ]\n\t);\n\n\tuseEffect( () => {\n\t\tif ( isParentNavigation ) {\n\t\t\tapiFetch( {\n\t\t\t\tpath: addQueryArgs( '/wp/v2/pages', {\n\t\t\t\t\tper_page: 1,\n\t\t\t\t\t_fields: [ 'id' ],\n\t\t\t\t} ),\n\t\t\t\tparse: false,\n\t\t\t} ).then( ( res ) => {\n\t\t\t\tsetAllowConvertToLinks(\n\t\t\t\t\tres.headers.get( 'X-WP-Total' ) <= MAX_PAGE_COUNT\n\t\t\t\t);\n\t\t\t} );\n\t\t} else {\n\t\t\tsetAllowConvertToLinks( false );\n\t\t}\n\t}, [ isParentNavigation ] );\n\n\tconst [ isOpen, setOpen ] = useState( false );\n\tconst openModal = () => setOpen( true );\n\tconst closeModal = () => setOpen( false );\n\n\treturn (\n\t\t<>\n\t\t\t{ allowConvertToLinks && (\n\t\t\t\t<BlockControls group=\"other\">\n\t\t\t\t\t<ToolbarButton title={ __( 'Edit' ) } onClick={ openModal }>\n\t\t\t\t\t\t{ __( 'Edit' ) }\n\t\t\t\t\t</ToolbarButton>\n\t\t\t\t</BlockControls>\n\t\t\t) }\n\t\t\t{ allowConvertToLinks && isOpen && (\n\t\t\t\t<ConvertToLinksModal\n\t\t\t\t\tonClose={ closeModal }\n\t\t\t\t\tclientId={ clientId }\n\t\t\t\t/>\n\t\t\t) }\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<ServerSideRender block=\"core/page-list\" />\n\t\t\t</div>\n\t\t</>\n\t);\n}\n"]}