{"version":3,"sources":["@wordpress/block-library/src/columns/edit.native.js"],"names":["View","Dimensions","dropRight","times","map","compact","delay","__","PanelBody","RangeControl","FooterMessageControl","UnitControl","getValueAndUnit","GlobalStylesContext","alignmentHelpers","InspectorControls","InnerBlocks","BlockControls","BlockVerticalAlignmentToolbar","BlockVariationPicker","store","blockEditorStore","withDispatch","useSelect","useEffect","useState","useContext","useMemo","useCallback","memo","useResizeObserver","createBlock","columns","variations","styles","hasExplicitPercentColumnWidths","getMappedColumnWidths","getRedistributedColumnWidths","toWidthPrecision","getWidths","getWidthWithUnit","isPercentageUnit","CSS_UNITS","getColumnsInRow","calculateContainerWidth","getContentWidths","ColumnsPreview","ALLOWED_BLOCKS","DEFAULT_COLUMNS_NUM","MIN_COLUMNS_NUM","isWider","isFullWidth","ColumnsEditContainer","attributes","updateAlignment","updateColumns","columnCount","isSelected","onDeleteBlock","innerWidths","updateInnerColumnWidth","editorSidebarOpened","resizeListener","sizes","columnsInRow","setColumnsInRow","screenWidth","Math","floor","get","width","globalStyles","verticalAlignment","align","newColumnCount","renderAppender","isEqualWidth","columnAppender","onAddBlock","contentWidths","onChangeWidth","nextWidth","valueUnit","columnId","widthWithUnit","onChangeUnit","nextUnit","index","widthWithoutUnit","parseFloat","onChange","getColumnsSliders","column","clientId","length","undefined","onChangeColumnsNum","value","innerBlocksSelected","ColumnsEditContainerWrapper","dispatch","ownProps","registry","setAttributes","updateBlockAttributes","select","getBlockOrder","innerBlockClientIds","forEach","innerBlockClientId","updateBlockSettings","settings","updateBlockListSettings","previousColumns","newColumns","replaceInnerBlocks","getBlocks","getBlockAttributes","innerBlocks","hasExplicitWidths","isAddingColumn","newColumnWidth","widths","onAddNextColumn","selectBlock","insertedBlock","removeBlock","ColumnsEdit","props","getBlockCount","getBlockParents","isEditorSidebarOpened","isContentEmpty","innerBlock","innerColumnsWidths","inn","parents","isDefaultColumns","hasParents","parentBlockAlignment","memoizedInnerWidths","JSON","stringify","isVisible","setIsVisible","onClose"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { View, Dimensions } from 'react-native';\nimport { dropRight, times, map, compact, delay } from 'lodash';\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport {\n\tPanelBody,\n\tRangeControl,\n\tFooterMessageControl,\n\tUnitControl,\n\tgetValueAndUnit,\n\tGlobalStylesContext,\n\talignmentHelpers,\n} from '@wordpress/components';\nimport {\n\tInspectorControls,\n\tInnerBlocks,\n\tBlockControls,\n\tBlockVerticalAlignmentToolbar,\n\tBlockVariationPicker,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport { withDispatch, useSelect } from '@wordpress/data';\nimport {\n\tuseEffect,\n\tuseState,\n\tuseContext,\n\tuseMemo,\n\tuseCallback,\n\tmemo,\n} from '@wordpress/element';\nimport { useResizeObserver } from '@wordpress/compose';\nimport { createBlock } from '@wordpress/blocks';\nimport { columns } from '@wordpress/icons';\n/**\n * Internal dependencies\n */\nimport variations from './variations';\nimport styles from './editor.scss';\nimport {\n\thasExplicitPercentColumnWidths,\n\tgetMappedColumnWidths,\n\tgetRedistributedColumnWidths,\n\ttoWidthPrecision,\n\tgetWidths,\n\tgetWidthWithUnit,\n\tisPercentageUnit,\n\tCSS_UNITS,\n} from './utils';\nimport {\n\tgetColumnsInRow,\n\tcalculateContainerWidth,\n\tgetContentWidths,\n} from './columnCalculations.native';\nimport ColumnsPreview from '../column/column-preview';\n\n/**\n * Allowed blocks constant is passed to InnerBlocks precisely as specified here.\n * The contents of the array should never change.\n * The array should contain the name of each block that is allowed.\n * In columns block, the only block we allow is 'core/column'.\n *\n * @constant\n * @type {string[]}\n */\nconst ALLOWED_BLOCKS = [ 'core/column' ];\n\n/**\n * Number of columns to assume for template in case the user opts to skip\n * template option selection.\n *\n * @type {number}\n */\nconst DEFAULT_COLUMNS_NUM = 2;\n\n/**\n * Minimum number of columns in a row\n *\n * @type {number}\n */\nconst MIN_COLUMNS_NUM = 1;\n\nconst { isWider, isFullWidth } = alignmentHelpers;\n\nfunction ColumnsEditContainer( {\n\tattributes,\n\tupdateAlignment,\n\tupdateColumns,\n\tcolumnCount,\n\tisSelected,\n\tonDeleteBlock,\n\tinnerWidths,\n\tupdateInnerColumnWidth,\n\teditorSidebarOpened,\n} ) {\n\tconst [ resizeListener, sizes ] = useResizeObserver();\n\tconst [ columnsInRow, setColumnsInRow ] = useState( MIN_COLUMNS_NUM );\n\tconst screenWidth = Math.floor( Dimensions.get( 'window' ).width );\n\tconst globalStyles = useContext( GlobalStylesContext );\n\n\tconst { verticalAlignment, align } = attributes;\n\tconst { width } = sizes || {};\n\n\tuseEffect( () => {\n\t\tif ( columnCount === 0 ) {\n\t\t\tconst newColumnCount = columnCount || DEFAULT_COLUMNS_NUM;\n\t\t\tupdateColumns( columnCount, newColumnCount );\n\t\t}\n\t}, [] );\n\n\tuseEffect( () => {\n\t\tif ( width ) {\n\t\t\tif ( getColumnsInRow( width, columnCount ) !== columnsInRow ) {\n\t\t\t\tsetColumnsInRow( getColumnsInRow( width, columnCount ) );\n\t\t\t}\n\t\t}\n\t}, [ width, columnCount ] );\n\n\tconst renderAppender = () => {\n\t\tconst isEqualWidth = width === screenWidth;\n\n\t\tif ( isSelected ) {\n\t\t\treturn (\n\t\t\t\t<View\n\t\t\t\t\tstyle={\n\t\t\t\t\t\t( isWider( screenWidth, 'mobile' ) || isEqualWidth ) &&\n\t\t\t\t\t\tstyles.columnAppender\n\t\t\t\t\t}\n\t\t\t\t>\n\t\t\t\t\t<InnerBlocks.ButtonBlockAppender\n\t\t\t\t\t\tonAddBlock={ onAddBlock }\n\t\t\t\t\t/>\n\t\t\t\t</View>\n\t\t\t);\n\t\t}\n\t\treturn null;\n\t};\n\n\tconst contentWidths = useMemo(\n\t\t() =>\n\t\t\tgetContentWidths(\n\t\t\t\tcolumnsInRow,\n\t\t\t\twidth,\n\t\t\t\tcolumnCount,\n\t\t\t\tinnerWidths,\n\t\t\t\tglobalStyles\n\t\t\t),\n\t\t[ width, columnsInRow, columnCount, innerWidths, globalStyles ]\n\t);\n\n\tconst onAddBlock = useCallback( () => {\n\t\tupdateColumns( columnCount, columnCount + 1 );\n\t}, [ columnCount ] );\n\n\tconst onChangeWidth = ( nextWidth, valueUnit, columnId ) => {\n\t\tconst widthWithUnit = getWidthWithUnit( nextWidth, valueUnit );\n\n\t\tupdateInnerColumnWidth( widthWithUnit, columnId );\n\t};\n\n\tconst onChangeUnit = ( nextUnit, index, columnId ) => {\n\t\tconst widthWithoutUnit = parseFloat(\n\t\t\tgetWidths( innerWidths )[ index ]\n\t\t);\n\t\tconst widthWithUnit = getWidthWithUnit( widthWithoutUnit, nextUnit );\n\n\t\tupdateInnerColumnWidth( widthWithUnit, columnId );\n\t};\n\n\tconst onChange = ( nextWidth, valueUnit, columnId ) => {\n\t\tif ( isPercentageUnit( valueUnit ) || ! valueUnit ) {\n\t\t\treturn;\n\t\t}\n\t\tonChangeWidth( nextWidth, valueUnit, columnId );\n\t};\n\n\tconst getColumnsSliders = useMemo( () => {\n\t\tif ( ! editorSidebarOpened || ! isSelected ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn innerWidths.map( ( column, index ) => {\n\t\t\tconst { valueUnit = '%' } =\n\t\t\t\tgetValueAndUnit( column.attributes.width ) || {};\n\t\t\treturn (\n\t\t\t\t<UnitControl\n\t\t\t\t\tlabel={ `Column ${ index + 1 }` }\n\t\t\t\t\tsettingLabel=\"Width\"\n\t\t\t\t\tkey={ `${ column.clientId }-${\n\t\t\t\t\t\tgetWidths( innerWidths ).length\n\t\t\t\t\t}` }\n\t\t\t\t\tmin={ 1 }\n\t\t\t\t\tmax={\n\t\t\t\t\t\tisPercentageUnit( valueUnit ) || ! valueUnit\n\t\t\t\t\t\t\t? 100\n\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t}\n\t\t\t\t\tdecimalNum={ 1 }\n\t\t\t\t\tvalue={ getWidths( innerWidths )[ index ] }\n\t\t\t\t\tonChange={ ( nextWidth ) => {\n\t\t\t\t\t\tonChange( nextWidth, valueUnit, column.clientId );\n\t\t\t\t\t} }\n\t\t\t\t\tonUnitChange={ ( nextUnit ) =>\n\t\t\t\t\t\tonChangeUnit( nextUnit, index, column.clientId )\n\t\t\t\t\t}\n\t\t\t\t\tonComplete={ ( nextWidth ) => {\n\t\t\t\t\t\tonChangeWidth( nextWidth, valueUnit, column.clientId );\n\t\t\t\t\t} }\n\t\t\t\t\tunit={ valueUnit }\n\t\t\t\t\tunits={ CSS_UNITS }\n\t\t\t\t\tpreview={\n\t\t\t\t\t\t<ColumnsPreview\n\t\t\t\t\t\t\tcolumnWidths={ getWidths( innerWidths, false ) }\n\t\t\t\t\t\t\tselectedColumnIndex={ index }\n\t\t\t\t\t\t/>\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t);\n\t\t} );\n\t}, [ editorSidebarOpened, isSelected, innerWidths ] );\n\n\tconst onChangeColumnsNum = useCallback(\n\t\t( value ) => {\n\t\t\tupdateColumns( columnCount, value );\n\t\t},\n\t\t[ columnCount ]\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t{ isSelected && (\n\t\t\t\t<>\n\t\t\t\t\t<InspectorControls>\n\t\t\t\t\t\t<PanelBody title={ __( 'Columns Settings' ) }>\n\t\t\t\t\t\t\t<RangeControl\n\t\t\t\t\t\t\t\tlabel={ __( 'Number of columns' ) }\n\t\t\t\t\t\t\t\ticon={ columns }\n\t\t\t\t\t\t\t\tvalue={ columnCount }\n\t\t\t\t\t\t\t\tonChange={ onChangeColumnsNum }\n\t\t\t\t\t\t\t\tmin={ MIN_COLUMNS_NUM }\n\t\t\t\t\t\t\t\tmax={ columnCount + 1 }\n\t\t\t\t\t\t\t\ttype=\"stepper\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{ getColumnsSliders }\n\t\t\t\t\t\t</PanelBody>\n\t\t\t\t\t\t<PanelBody>\n\t\t\t\t\t\t\t<FooterMessageControl\n\t\t\t\t\t\t\t\tlabel={ __(\n\t\t\t\t\t\t\t\t\t'Note: Column layout may vary between themes and screen sizes'\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</PanelBody>\n\t\t\t\t\t</InspectorControls>\n\t\t\t\t\t<BlockControls>\n\t\t\t\t\t\t<BlockVerticalAlignmentToolbar\n\t\t\t\t\t\t\tonChange={ updateAlignment }\n\t\t\t\t\t\t\tvalue={ verticalAlignment }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</BlockControls>\n\t\t\t\t</>\n\t\t\t) }\n\t\t\t<View style={ isSelected && styles.innerBlocksSelected }>\n\t\t\t\t{ resizeListener }\n\t\t\t\t{ width && (\n\t\t\t\t\t<InnerBlocks\n\t\t\t\t\t\trenderAppender={ renderAppender }\n\t\t\t\t\t\torientation={\n\t\t\t\t\t\t\tcolumnsInRow > 1 ? 'horizontal' : undefined\n\t\t\t\t\t\t}\n\t\t\t\t\t\thorizontal={ true }\n\t\t\t\t\t\tallowedBlocks={ ALLOWED_BLOCKS }\n\t\t\t\t\t\tcontentResizeMode=\"stretch\"\n\t\t\t\t\t\tonAddBlock={ onAddBlock }\n\t\t\t\t\t\tonDeleteBlock={\n\t\t\t\t\t\t\tcolumnCount === 1 ? onDeleteBlock : undefined\n\t\t\t\t\t\t}\n\t\t\t\t\t\tblockWidth={ width }\n\t\t\t\t\t\tcontentStyle={ contentWidths }\n\t\t\t\t\t\tparentWidth={\n\t\t\t\t\t\t\tisFullWidth( align ) && columnCount === 0\n\t\t\t\t\t\t\t\t? screenWidth\n\t\t\t\t\t\t\t\t: calculateContainerWidth( width, columnsInRow )\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t</View>\n\t\t</>\n\t);\n}\n\nconst ColumnsEditContainerWrapper = withDispatch(\n\t( dispatch, ownProps, registry ) => ( {\n\t\t/**\n\t\t * Update all child Column blocks with a new vertical alignment setting\n\t\t * based on whatever alignment is passed in. This allows change to parent\n\t\t * to overide anything set on a individual column basis.\n\t\t *\n\t\t * @param {string} verticalAlignment the vertical alignment setting\n\t\t */\n\t\tupdateAlignment( verticalAlignment ) {\n\t\t\tconst { clientId, setAttributes } = ownProps;\n\t\t\tconst { updateBlockAttributes } = dispatch( blockEditorStore );\n\t\t\tconst { getBlockOrder } = registry.select( blockEditorStore );\n\n\t\t\t// Update own alignment.\n\t\t\tsetAttributes( { verticalAlignment } );\n\n\t\t\t// Update all child Column Blocks to match\n\t\t\tconst innerBlockClientIds = getBlockOrder( clientId );\n\t\t\tinnerBlockClientIds.forEach( ( innerBlockClientId ) => {\n\t\t\t\tupdateBlockAttributes( innerBlockClientId, {\n\t\t\t\t\tverticalAlignment,\n\t\t\t\t} );\n\t\t\t} );\n\t\t},\n\t\tupdateInnerColumnWidth( value, columnId ) {\n\t\t\tconst { updateBlockAttributes } = dispatch( blockEditorStore );\n\n\t\t\tupdateBlockAttributes( columnId, {\n\t\t\t\twidth: value,\n\t\t\t} );\n\t\t},\n\t\tupdateBlockSettings( settings ) {\n\t\t\tconst { clientId } = ownProps;\n\t\t\tconst { updateBlockListSettings } = dispatch( blockEditorStore );\n\t\t\tupdateBlockListSettings( clientId, settings );\n\t\t},\n\t\t/**\n\t\t * Updates the column columnCount, including necessary revisions to child Column\n\t\t * blocks to grant required or redistribute available space.\n\t\t *\n\t\t * @param {number} previousColumns Previous column columnCount.\n\t\t * @param {number} newColumns      New column columnCount.\n\t\t */\n\t\tupdateColumns( previousColumns, newColumns ) {\n\t\t\tconst { clientId } = ownProps;\n\t\t\tconst { replaceInnerBlocks } = dispatch( blockEditorStore );\n\t\t\tconst { getBlocks, getBlockAttributes } = registry.select(\n\t\t\t\tblockEditorStore\n\t\t\t);\n\n\t\t\tlet innerBlocks = getBlocks( clientId );\n\t\t\tconst hasExplicitWidths = hasExplicitPercentColumnWidths(\n\t\t\t\tinnerBlocks\n\t\t\t);\n\n\t\t\t// Redistribute available width for existing inner blocks.\n\t\t\tconst isAddingColumn = newColumns > previousColumns;\n\n\t\t\t// Get verticalAlignment from Columns block to set the same to new Column\n\t\t\tconst { verticalAlignment } = getBlockAttributes( clientId ) || {};\n\n\t\t\tif ( isAddingColumn && hasExplicitWidths ) {\n\t\t\t\t// If adding a new column, assign width to the new column equal to\n\t\t\t\t// as if it were `1 / columns` of the total available space.\n\t\t\t\tconst newColumnWidth = toWidthPrecision( 100 / newColumns );\n\n\t\t\t\t// Redistribute in consideration of pending block insertion as\n\t\t\t\t// constraining the available working width.\n\t\t\t\tconst widths = getRedistributedColumnWidths(\n\t\t\t\t\tinnerBlocks,\n\t\t\t\t\t100 - newColumnWidth\n\t\t\t\t);\n\n\t\t\t\tinnerBlocks = [\n\t\t\t\t\t...getMappedColumnWidths( innerBlocks, widths ),\n\t\t\t\t\t...times( newColumns - previousColumns, () => {\n\t\t\t\t\t\treturn createBlock( 'core/column', {\n\t\t\t\t\t\t\twidth: newColumnWidth,\n\t\t\t\t\t\t\tverticalAlignment,\n\t\t\t\t\t\t} );\n\t\t\t\t\t} ),\n\t\t\t\t];\n\t\t\t} else if ( isAddingColumn ) {\n\t\t\t\tinnerBlocks = [\n\t\t\t\t\t...innerBlocks,\n\t\t\t\t\t...times( newColumns - previousColumns, () => {\n\t\t\t\t\t\treturn createBlock( 'core/column', {\n\t\t\t\t\t\t\tverticalAlignment,\n\t\t\t\t\t\t} );\n\t\t\t\t\t} ),\n\t\t\t\t];\n\t\t\t} else {\n\t\t\t\t// The removed column will be the last of the inner blocks.\n\t\t\t\tinnerBlocks = dropRight(\n\t\t\t\t\tinnerBlocks,\n\t\t\t\t\tpreviousColumns - newColumns\n\t\t\t\t);\n\n\t\t\t\tif ( hasExplicitWidths ) {\n\t\t\t\t\t// Redistribute as if block is already removed.\n\t\t\t\t\tconst widths = getRedistributedColumnWidths(\n\t\t\t\t\t\tinnerBlocks,\n\t\t\t\t\t\t100\n\t\t\t\t\t);\n\n\t\t\t\t\tinnerBlocks = getMappedColumnWidths( innerBlocks, widths );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treplaceInnerBlocks( clientId, innerBlocks );\n\t\t},\n\t\tonAddNextColumn: () => {\n\t\t\tconst { clientId } = ownProps;\n\t\t\tconst { replaceInnerBlocks, selectBlock } = dispatch(\n\t\t\t\tblockEditorStore\n\t\t\t);\n\t\t\tconst { getBlocks, getBlockAttributes } = registry.select(\n\t\t\t\tblockEditorStore\n\t\t\t);\n\n\t\t\t// Get verticalAlignment from Columns block to set the same to new Column\n\t\t\tconst { verticalAlignment } = getBlockAttributes( clientId );\n\n\t\t\tconst innerBlocks = getBlocks( clientId );\n\n\t\t\tconst insertedBlock = createBlock( 'core/column', {\n\t\t\t\tverticalAlignment,\n\t\t\t} );\n\n\t\t\treplaceInnerBlocks(\n\t\t\t\tclientId,\n\t\t\t\t[ ...innerBlocks, insertedBlock ],\n\t\t\t\ttrue\n\t\t\t);\n\t\t\tselectBlock( insertedBlock.clientId );\n\t\t},\n\t\tonDeleteBlock: () => {\n\t\t\tconst { clientId } = ownProps;\n\t\t\tconst { removeBlock } = dispatch( blockEditorStore );\n\t\t\tremoveBlock( clientId );\n\t\t},\n\t} )\n)( memo( ColumnsEditContainer ) );\n\nconst ColumnsEdit = ( props ) => {\n\tconst { clientId, isSelected } = props;\n\tconst {\n\t\tcolumnCount,\n\t\tisDefaultColumns,\n\t\tinnerWidths = [],\n\t\thasParents,\n\t\tparentBlockAlignment,\n\t\teditorSidebarOpened,\n\t} = useSelect(\n\t\t( select ) => {\n\t\t\tconst {\n\t\t\t\tgetBlockCount,\n\t\t\t\tgetBlocks,\n\t\t\t\tgetBlockParents,\n\t\t\t\tgetBlockAttributes,\n\t\t\t} = select( blockEditorStore );\n\t\t\tconst { isEditorSidebarOpened } = select( 'core/edit-post' );\n\t\t\tconst innerBlocks = getBlocks( clientId );\n\n\t\t\tconst isContentEmpty = map(\n\t\t\t\tinnerBlocks,\n\t\t\t\t( innerBlock ) => innerBlock.innerBlocks.length\n\t\t\t);\n\n\t\t\tconst innerColumnsWidths = innerBlocks.map( ( inn ) => ( {\n\t\t\t\tclientId: inn.clientId,\n\t\t\t\tattributes: { width: inn.attributes.width },\n\t\t\t} ) );\n\t\t\tconst parents = getBlockParents( clientId, true );\n\n\t\t\treturn {\n\t\t\t\tcolumnCount: getBlockCount( clientId ),\n\t\t\t\tisDefaultColumns: ! compact( isContentEmpty ).length,\n\t\t\t\tinnerWidths: innerColumnsWidths,\n\t\t\t\thasParents: !! parents.length,\n\t\t\t\tparentBlockAlignment: getBlockAttributes( parents[ 0 ] )?.align,\n\t\t\t\teditorSidebarOpened: isSelected && isEditorSidebarOpened(),\n\t\t\t};\n\t\t},\n\t\t[ clientId, isSelected ]\n\t);\n\n\tconst memoizedInnerWidths = useMemo( () => {\n\t\treturn innerWidths;\n\t}, [\n\t\t// The JSON.stringify is used because innerWidth is always a new reference.\n\t\t// The innerBlocks is a new reference after each attribute change of any nested block.\n\t\tJSON.stringify( innerWidths ),\n\t] );\n\n\tconst [ isVisible, setIsVisible ] = useState( false );\n\n\tuseEffect( () => {\n\t\tif ( isSelected && isDefaultColumns ) {\n\t\t\tdelay( () => setIsVisible( true ), 100 );\n\t\t}\n\t}, [] );\n\n\tconst onClose = useCallback( () => {\n\t\tsetIsVisible( false );\n\t}, [] );\n\n\treturn (\n\t\t<>\n\t\t\t<ColumnsEditContainerWrapper\n\t\t\t\tcolumnCount={ columnCount }\n\t\t\t\tinnerWidths={ memoizedInnerWidths }\n\t\t\t\thasParents={ hasParents }\n\t\t\t\tparentBlockAlignment={ parentBlockAlignment }\n\t\t\t\teditorSidebarOpened={ editorSidebarOpened }\n\t\t\t\t{ ...props }\n\t\t\t/>\n\t\t\t<BlockVariationPicker\n\t\t\t\tvariations={ variations }\n\t\t\t\tonClose={ onClose }\n\t\t\t\tclientId={ clientId }\n\t\t\t\tisVisible={ isVisible }\n\t\t\t/>\n\t\t</>\n\t);\n};\n\nexport default ColumnsEdit;\n"]}