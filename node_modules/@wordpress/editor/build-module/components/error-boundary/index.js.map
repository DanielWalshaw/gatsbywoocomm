{"version":3,"sources":["@wordpress/editor/src/components/error-boundary/index.js"],"names":["Component","__","Button","select","Warning","useCopyToClipboard","CopyButton","text","children","ref","ErrorBoundary","arguments","reboot","bind","getContent","state","error","setState","props","onError","getEditedPostContent","stack"],"mappings":";;;;;;;;;;;;AAAA;AACA;AACA;AACA,SAASA,SAAT,QAA0B,oBAA1B;AACA,SAASC,EAAT,QAAmB,iBAAnB;AACA,SAASC,MAAT,QAAuB,uBAAvB;AACA,SAASC,MAAT,QAAuB,iBAAvB;AACA,SAASC,OAAT,QAAwB,yBAAxB;AACA,SAASC,kBAAT,QAAmC,oBAAnC;;AAEA,SAASC,UAAT,OAA0C;AAAA,MAAnBC,IAAmB,QAAnBA,IAAmB;AAAA,MAAbC,QAAa,QAAbA,QAAa;AACzC,MAAMC,GAAG,GAAGJ,kBAAkB,CAAEE,IAAF,CAA9B;AACA,SACC,cAAC,MAAD;AAAQ,IAAA,WAAW,MAAnB;AAAoB,IAAA,GAAG,EAAGE;AAA1B,KACGD,QADH,CADD;AAKA;;IAEKE,a;;;;;AACL,2BAAc;AAAA;;AAAA;;AACb,+BAAUC,SAAV;AAEA,UAAKC,MAAL,GAAc,MAAKA,MAAL,CAAYC,IAAZ,+BAAd;AACA,UAAKC,UAAL,GAAkB,MAAKA,UAAL,CAAgBD,IAAhB,+BAAlB;AAEA,UAAKE,KAAL,GAAa;AACZC,MAAAA,KAAK,EAAE;AADK,KAAb;AANa;AASb;;;;WAED,2BAAmBA,KAAnB,EAA2B;AAC1B,WAAKC,QAAL,CAAe;AAAED,QAAAA,KAAK,EAALA;AAAF,OAAf;AACA;;;WAED,kBAAS;AACR,WAAKE,KAAL,CAAWC,OAAX;AACA;;;WAED,sBAAa;AACZ,UAAI;AACH;AACA;AACA;AACA;AACA;AACA;AACA,eAAOhB,MAAM,CAAE,aAAF,CAAN,CAAwBiB,oBAAxB,EAAP;AACA,OARD,CAQE,OAAQJ,KAAR,EAAgB,CAAE;AACpB;;;WAED,kBAAS;AAAA,UACAA,KADA,GACU,KAAKD,KADf,CACAC,KADA;;AAER,UAAK,CAAEA,KAAP,EAAe;AACd,eAAO,KAAKE,KAAL,CAAWV,QAAlB;AACA;;AAED,aACC,cAAC,OAAD;AACC,QAAA,SAAS,EAAC,uBADX;AAEC,QAAA,OAAO,EAAG,CACT,cAAC,MAAD;AAAQ,UAAA,GAAG,EAAC,UAAZ;AAAuB,UAAA,OAAO,EAAG,KAAKI,MAAtC;AAA+C,UAAA,WAAW;AAA1D,WACGX,EAAE,CAAE,kBAAF,CADL,CADS,EAIT,cAAC,UAAD;AAAY,UAAA,GAAG,EAAC,WAAhB;AAA4B,UAAA,IAAI,EAAG,KAAKa;AAAxC,WACGb,EAAE,CAAE,gBAAF,CADL,CAJS,EAOT,cAAC,UAAD;AAAY,UAAA,GAAG,EAAC,YAAhB;AAA6B,UAAA,IAAI,EAAGe,KAAK,CAACK;AAA1C,WACGpB,EAAE,CAAE,YAAF,CADL,CAPS;AAFX,SAcGA,EAAE,CAAE,iDAAF,CAdL,CADD;AAkBA;;;;EAxD0BD,S;;AA2D5B,eAAeU,aAAf","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport { Button } from '@wordpress/components';\nimport { select } from '@wordpress/data';\nimport { Warning } from '@wordpress/block-editor';\nimport { useCopyToClipboard } from '@wordpress/compose';\n\nfunction CopyButton( { text, children } ) {\n\tconst ref = useCopyToClipboard( text );\n\treturn (\n\t\t<Button isSecondary ref={ ref }>\n\t\t\t{ children }\n\t\t</Button>\n\t);\n}\n\nclass ErrorBoundary extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.reboot = this.reboot.bind( this );\n\t\tthis.getContent = this.getContent.bind( this );\n\n\t\tthis.state = {\n\t\t\terror: null,\n\t\t};\n\t}\n\n\tcomponentDidCatch( error ) {\n\t\tthis.setState( { error } );\n\t}\n\n\treboot() {\n\t\tthis.props.onError();\n\t}\n\n\tgetContent() {\n\t\ttry {\n\t\t\t// While `select` in a component is generally discouraged, it is\n\t\t\t// used here because it (a) reduces the chance of data loss in the\n\t\t\t// case of additional errors by performing a direct retrieval and\n\t\t\t// (b) avoids the performance cost associated with unnecessary\n\t\t\t// content serialization throughout the lifetime of a non-erroring\n\t\t\t// application.\n\t\t\treturn select( 'core/editor' ).getEditedPostContent();\n\t\t} catch ( error ) {}\n\t}\n\n\trender() {\n\t\tconst { error } = this.state;\n\t\tif ( ! error ) {\n\t\t\treturn this.props.children;\n\t\t}\n\n\t\treturn (\n\t\t\t<Warning\n\t\t\t\tclassName=\"editor-error-boundary\"\n\t\t\t\tactions={ [\n\t\t\t\t\t<Button key=\"recovery\" onClick={ this.reboot } isSecondary>\n\t\t\t\t\t\t{ __( 'Attempt Recovery' ) }\n\t\t\t\t\t</Button>,\n\t\t\t\t\t<CopyButton key=\"copy-post\" text={ this.getContent }>\n\t\t\t\t\t\t{ __( 'Copy Post Text' ) }\n\t\t\t\t\t</CopyButton>,\n\t\t\t\t\t<CopyButton key=\"copy-error\" text={ error.stack }>\n\t\t\t\t\t\t{ __( 'Copy Error' ) }\n\t\t\t\t\t</CopyButton>,\n\t\t\t\t] }\n\t\t\t>\n\t\t\t\t{ __( 'The editor has encountered an unexpected error.' ) }\n\t\t\t</Warning>\n\t\t);\n\t}\n}\n\nexport default ErrorBoundary;\n"]}