"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useScrollIntoView = useScrollIntoView;

var _domScrollIntoView = _interopRequireDefault(require("dom-scroll-into-view"));

var _element = require("@wordpress/element");

var _data = require("@wordpress/data");

var _dom = require("@wordpress/dom");

var _store = require("../../../store");

/**
 * External dependencies
 */

/**
 * WordPress dependencies
 */

/**
 * WordPress dependencies
 */

/**
 * Internal dependencies
 */
function useScrollIntoView(clientId) {
  var ref = (0, _element.useRef)();
  var isSelectionEnd = (0, _data.useSelect)(function (select) {
    var _select = select(_store.store),
        isBlockSelected = _select.isBlockSelected,
        getBlockSelectionEnd = _select.getBlockSelectionEnd;

    return isBlockSelected(clientId) || getBlockSelectionEnd() === clientId;
  }, [clientId]);
  (0, _element.useEffect)(function () {
    if (!isSelectionEnd) {
      return;
    }

    var extentNode = ref.current; // If the block is focused, the browser will already have scrolled into
    // view if necessary.

    if (extentNode.contains(extentNode.ownerDocument.activeElement)) {
      return;
    }

    var scrollContainer = (0, _dom.getScrollContainer)(extentNode); // If there's no scroll container, it follows that there's no scrollbar
    // and thus there's no need to try to scroll into view.

    if (!scrollContainer) {
      return;
    }

    (0, _domScrollIntoView.default)(extentNode, scrollContainer, {
      onlyScrollIfNeeded: true
    });
  }, [isSelectionEnd]);
  return ref;
}
//# sourceMappingURL=use-scroll-into-view.js.map