{"version":3,"sources":["@wordpress/block-editor/src/components/block-list/use-block-props/use-nav-mode-exit.js"],"names":["useNavModeExit","clientId","blockEditorStore","isNavigationMode","isBlockSelected","setNavigationMode","selectBlock","node","onMouseDown","event","defaultPrevented","preventDefault","addEventListener"],"mappings":";;;;;;;AAGA;;AACA;;AAKA;;AATA;AACA;AACA;;AAIA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;AACO,SAASA,cAAT,CAAyBC,QAAzB,EAAoC;AAAA,mBACI,qBAAWC,YAAX,CADJ;AAAA,MAClCC,gBADkC,cAClCA,gBADkC;AAAA,MAChBC,eADgB,cAChBA,eADgB;;AAAA,qBAEC,uBAAaF,YAAb,CAFD;AAAA,MAElCG,iBAFkC,gBAElCA,iBAFkC;AAAA,MAEfC,WAFe,gBAEfA,WAFe;;AAG1C,SAAO,2BACN,UAAEC,IAAF,EAAY;AACX,aAASC,WAAT,CAAsBC,KAAtB,EAA8B;AAC7B;AACA;AACA,UAAKN,gBAAgB,MAAM,CAAEM,KAAK,CAACC,gBAAnC,EAAsD;AACrD;AACAD,QAAAA,KAAK,CAACE,cAAN,GAFqD,CAIrD;;AACA,YAAKP,eAAe,CAAEH,QAAF,CAApB,EAAmC;AAClCI,UAAAA,iBAAiB,CAAE,KAAF,CAAjB;AACA,SAFD,MAEO;AACNC,UAAAA,WAAW,CAAEL,QAAF,CAAX;AACA;AACD;AACD;;AAEDM,IAAAA,IAAI,CAACK,gBAAL,CAAuB,WAAvB,EAAoCJ,WAApC;AAEA,WAAO,YAAM;AACZD,MAAAA,IAAI,CAACK,gBAAL,CAAuB,WAAvB,EAAoCJ,WAApC;AACA,KAFD;AAGA,GAvBK,EAwBN,CAAEP,QAAF,EAAYE,gBAAZ,EAA8BC,eAA9B,EAA+CC,iBAA/C,CAxBM,CAAP;AA0BA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { useRefEffect } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport { store as blockEditorStore } from '../../../store';\n\n/**\n * Allows navigation mode to be exited by clicking in the selected block.\n *\n * @param {string} clientId Block client ID.\n */\nexport function useNavModeExit( clientId ) {\n\tconst { isNavigationMode, isBlockSelected } = useSelect( blockEditorStore );\n\tconst { setNavigationMode, selectBlock } = useDispatch( blockEditorStore );\n\treturn useRefEffect(\n\t\t( node ) => {\n\t\t\tfunction onMouseDown( event ) {\n\t\t\t\t// Don't select a block if it's already handled by a child\n\t\t\t\t// block.\n\t\t\t\tif ( isNavigationMode() && ! event.defaultPrevented ) {\n\t\t\t\t\t// Prevent focus from moving to the block.\n\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\t// When clicking on a selected block, exit navigation mode.\n\t\t\t\t\tif ( isBlockSelected( clientId ) ) {\n\t\t\t\t\t\tsetNavigationMode( false );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tselectBlock( clientId );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tnode.addEventListener( 'mousedown', onMouseDown );\n\n\t\t\treturn () => {\n\t\t\t\tnode.addEventListener( 'mousedown', onMouseDown );\n\t\t\t};\n\t\t},\n\t\t[ clientId, isNavigationMode, isBlockSelected, setNavigationMode ]\n\t);\n}\n"]}